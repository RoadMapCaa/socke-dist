"use strict";(self.webpackChunksocket_pwa=self.webpackChunksocket_pwa||[]).push([[372],{1372:(W,f,s)=>{s.r(f),s.d(f,{AuthModule:()=>G});var p=s(9808),l=s(9539),t=s(5e3);let A=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-auth"]],decls:3,vars:0,consts:[[1,"vh-100"],[1,"container","py-5","h-100"]],template:function(o,n){1&o&&(t.TgZ(0,"section",0),t.TgZ(1,"div",1),t._UZ(2,"router-outlet"),t.qZA(),t.qZA())},directives:[l.lC],styles:[""]}),e})();var i=s(2382),h=s(7556),v=s(2290),u=s(9444);const T=function(){return["fas","sign-in-alt"]};function x(e,r){if(1&e&&(t.TgZ(0,"button",19),t._UZ(1,"fa-icon",20),t._uU(2," Ingresar "),t.qZA()),2&e){const o=t.oxw();t.Q6J("disabled",o.form.invalid),t.xp6(1),t.Q6J("icon",t.DdM(2,T))}}const C=function(){return["fas","spinner"]};function y(e,r){1&e&&(t.TgZ(0,"button",21),t._UZ(1,"fa-icon",22),t._uU(2," Espere... "),t.qZA()),2&e&&(t.xp6(1),t.Q6J("icon",t.DdM(2,C))("spin",!0))}let q=(()=>{class e{constructor(o,n,a,c){this.fb=o,this.authService=n,this.toastrService=a,this.router=c,this.loading=!1,this.form=this.fb.group({username:["",i.kI.required],password:["",i.kI.required]})}ngOnInit(){}login(){this.form.invalid||(this.loading=!0,this.authService.login(this.form.value).subscribe(({user:o})=>{this.setRole(o)},o=>{this.loading=!1,this.toastrService.error(o.error.error,"Error")}))}setRole(o){const{isDriver:n,isControl:a,isAssistant:c,isOperator:m,isSorter:O,isPicking:V}=o;n?(this.router.navigateByUrl("control/driver"),this.saveRoute("control/driver")):a?(this.router.navigateByUrl("control/control"),this.saveRoute("control/control")):c?(this.router.navigateByUrl("control/warehouse"),this.saveRoute("control/warehouse")):m?(this.router.navigateByUrl("control/lift"),this.saveRoute("control/lift")):O?(this.router.navigateByUrl("sorting/form"),this.saveRoute("sorting/form")):V&&(this.router.navigateByUrl("picking/enlistment"),this.saveRoute("picking/enlistment"))}saveRoute(o){localStorage.setItem("route",o)}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(i.qu),t.Y36(h.e),t.Y36(v._W),t.Y36(l.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-login"]],decls:32,vars:3,consts:[[1,"row","d-flex","justify-content-center","align-items-center","h-100"],[1,"col-12","col-md-8","col-lg-6","col-xl-5"],[1,"card",2,"border-radius","1rem"],[1,"card-body","p-md-5"],[1,"mb-md-5","mt-md-4","pb-3"],[1,"mb-3","text-center"],["src","../../../../assets/images/logo.png","width","85",1,"img-fluid","mb-2"],[1,"fw-bold","mb-2"],[1,"mb-3"],[3,"formGroup","submit"],[1,"form-label","text-start"],["formControlName","username","type","text","placeholder","Ingrese usuario o c\xe9dula","autocomplete","off",1,"form-control"],["formControlName","password","type","password","placeholder","Ingrese contrase\xf1a","name","password","autocomplete","off",1,"form-control"],[1,"d-grid","gap-2"],["class","btn btn-primary px-5","type","submit",3,"disabled",4,"ngIf"],["type","button","class","btn btn-primary px-5","disabled","",4,"ngIf"],["routerLink","/auth/registration",1,"fw-bold"],[1,"text-center"],["routerLink","/tv/home"],["type","submit",1,"btn","btn-primary","px-5",3,"disabled"],["size","lg",3,"icon"],["type","button","disabled","",1,"btn","btn-primary","px-5"],[3,"icon","spin"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"div",4),t.TgZ(5,"div",5),t._UZ(6,"img",6),t.TgZ(7,"h4",7),t._uU(8,"Sistema de colas"),t.qZA(),t.TgZ(9,"h5",8),t._uU(10,"Ingresar"),t.qZA(),t.qZA(),t.TgZ(11,"form",9),t.NdJ("submit",function(){return n.login()}),t.TgZ(12,"div",8),t.TgZ(13,"label",10),t._uU(14,"Usuario*"),t.qZA(),t._UZ(15,"input",11),t.qZA(),t.TgZ(16,"div",8),t.TgZ(17,"label",10),t._uU(18,"Contrase\xf1a*"),t.qZA(),t._UZ(19,"input",12),t.qZA(),t.TgZ(20,"div",13),t.YNc(21,x,3,3,"button",14),t.YNc(22,y,3,3,"button",15),t.qZA(),t.qZA(),t.qZA(),t.TgZ(23,"div"),t.TgZ(24,"p"),t._uU(25," \xbfNo tienes cuenta todav\xeda? "),t.TgZ(26,"a",16),t._uU(27," Registrarme "),t.qZA(),t.qZA(),t.TgZ(28,"p",17),t.TgZ(29,"small"),t.TgZ(30,"a",18),t._uU(31," Show panel "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o&&(t.xp6(11),t.Q6J("formGroup",n.form),t.xp6(10),t.Q6J("ngIf",!n.loading),t.xp6(1),t.Q6J("ngIf",n.loading))},directives:[i._Y,i.JL,i.sg,i.Fj,i.JJ,i.u,p.O5,u.BN,l.yS],styles:[""]}),e})();var g=s(1134);const Z=function(e){return["fas",e]};let b=(()=>{class e{constructor(o,n){this.bsModalRef=o,this.router=n}ngOnInit(){}navigate(){this.bsModalRef.hide(),this.router.navigateByUrl(this.link)}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(g.UZ),t.Y36(l.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-modal-confirm"]],decls:11,vars:15,consts:[[1,"p-3"],[1,"text-center"],["size","2x",3,"icon"],[1,"mb-3"],[1,"d-grid","gap-2"],[1,"btn","btn-primary",3,"click"],[3,"icon"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h3"),t._uU(3),t.qZA(),t._UZ(4,"fa-icon",2),t.TgZ(5,"p",3),t._uU(6),t.qZA(),t.TgZ(7,"div",4),t.TgZ(8,"button",5),t.NdJ("click",function(){return n.navigate()}),t._UZ(9,"fa-icon",6),t._uU(10),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o&&(t.xp6(2),t.Tol(n.color),t.xp6(1),t.Oqu(n.title),t.xp6(1),t.Gre("",n.colorIcon," mb-3"),t.Q6J("icon",t.VKq(11,Z,n.icon)),t.xp6(2),t.hij(" ",n.message," "),t.xp6(3),t.Q6J("icon",t.VKq(13,Z,n.iconBtn)),t.xp6(1),t.hij(" ",n.textBtn," "))},directives:[u.BN],encapsulation:2}),e})();var U=s(2340),I=s(9646),N=s(5963),M=s(3900),R=s(4004),_=s(520);const{endpoint:J}=U.N;let S=(()=>{class e{constructor(o,n){this.http=o,this.modalService=n}validate(){return o=>o.pristine?(0,I.of)(null):(0,N.H)(500).pipe((0,M.w)(()=>this.validateCedula(o.value)),(0,R.U)(n=>n?(this.openModalConfirm(n),{documentAlreadyExists:!0}):null))}validateCedula(o){return this.http.get(`${J}/auth/exist-user?document=${o}`)}openModalConfirm(o){this.bsModalRef=this.modalService.show(b,this.itIsRegistered(o)),this.bsModalRef.content.closeBtnName="Close"}itIsRegistered(o){const{firstName:n,lastName:a}=o;return{class:"modal-dialog-centered",initialState:{title:"\xa1Ya est\xe1 registrado!",color:"text-danger",colorIcon:"text-warning",message:`Sr. ${n} ${a}, usted ya esta registrado en el sistema de colas "WMS".Proceda a iniciar sesi\xf3n o registrarse desde el control.`,icon:"exclamation-triangle",iconBtn:"arrow-alt-circle-right",link:"/auth/login",textBtn:"Iniciar sesi\xf3n"}}}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(_.eN),t.LFG(g.tT))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function B(e,r){if(1&e&&(t.TgZ(0,"span",21),t._uU(1),t.qZA()),2&e){const o=t.oxw();t.xp6(1),t.hij(" ",o.documentErrorMsg," ")}}function F(e,r){1&e&&(t.TgZ(0,"span",21),t._uU(1," Nombres es requerido "),t.qZA())}function Y(e,r){1&e&&(t.TgZ(0,"span",21),t._uU(1," Apellidos es requerido "),t.qZA())}function L(e,r){1&e&&(t.TgZ(0,"span",21),t._uU(1," Licencia es requerido "),t.qZA())}function w(e,r){1&e&&(t.TgZ(0,"span",21),t._uU(1," Categor\xeda es requerido "),t.qZA())}const k=function(){return["fas","book"]};function Q(e,r){if(1&e&&(t.TgZ(0,"button",22),t._UZ(1,"fa-icon",23),t._uU(2," Registrame "),t.qZA()),2&e){const o=t.oxw();t.Q6J("disabled",o.form.invalid),t.xp6(1),t.Q6J("icon",t.DdM(2,k))}}const E=function(){return["fas","spinner"]};function j(e,r){1&e&&(t.TgZ(0,"button",24),t._UZ(1,"fa-icon",23),t._uU(2," Espere... "),t.qZA()),2&e&&(t.xp6(1),t.Q6J("icon",t.DdM(1,E)))}const D=[{path:"",component:A,children:[{path:"login",component:q},{path:"registration",component:(()=>{class e{constructor(o,n,a,c,m){this.modalService=o,this.fb=n,this.cedulaValidator=a,this.authService=c,this.toastrService=m,this.loading=!1,this.form=this.fb.group({document:["",[i.kI.required,i.kI.minLength(8),i.kI.pattern("^[0-9]*$")],[this.cedulaValidator.validate()]],firstName:["",[i.kI.required,i.kI.maxLength(40)]],lastName:["",[i.kI.required,i.kI.maxLength(50)]],licence:["",[i.kI.required,i.kI.maxLength(10)]],category:["",[i.kI.required,i.kI.maxLength(8)]],isDriver:[!0]})}ngOnInit(){}openModalConfirm(o){this.bsModalRef=this.modalService.show(b,this.isRegistered(o)),this.bsModalRef.content.closeBtnName="Close"}isRegistered(o){const{firstName:n,lastName:a,username:c,password:m}=o;return{class:"modal-dialog-centered",keyboard:!1,ignoreBackdropClick:!0,initialState:{title:"\xa1\xa1\xa1Registro exitoso!!!",color:"text-success",colorIcon:"text-success",message:`Bienvenido Sr. ${n} ${a}, sea registrado correctamente en el sistema de colas "WMS". \n          \n Usuario: ${c} \n          \n Contrase\xf1a: ${m}`,icon:"check",iconBtn:"arrow-alt-circle-right",link:"/auth/login",textBtn:"Adelante"}}}get documentErrorMsg(){var o;const n=null===(o=this.form.get("document"))||void 0===o?void 0:o.errors;return(null==n?void 0:n.required)?"Dni es requerido":n.documentAlreadyExists?"Ya existe usuario con ese documento":(null==n?void 0:n.minlength)?"DNI debe tener al menos 8 caracteres":(null==n?void 0:n.pattern)?"Solo se acepta n\xfameros":""}invalidField(o){var n,a;return(null===(n=this.form.get(o))||void 0===n?void 0:n.invalid)&&(null===(a=this.form.get(o))||void 0===a?void 0:a.touched)}register(){this.form.invalid||(this.loading=!0,this.authService.register(this.form.value).subscribe(o=>{this.openModalConfirm(o),this.loading=!1},o=>{this.loading=!1,this.toastrService.error(o.error.error,"Error")}))}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(g.tT),t.Y36(i.qu),t.Y36(S),t.Y36(h.e),t.Y36(v._W))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-registration"]],decls:34,vars:8,consts:[[1,"row","d-flex","justify-content-center","align-items-center","h-100"],[1,"col-12","col-md-8","col-lg-6","col-xl-5"],[1,"card","shadow",2,"border-radius","1rem"],[1,"card-body","p-md-5"],[1,"mb-md-5","mt-md-2","pb-2"],[1,"text-center"],[1,"mb-3"],["src","../../../../assets/images/logo.png",1,"img-fluid","mb-2",2,"width","85px"],[1,"fw-bold","mb-3"],[3,"formGroup","submit"],["formControlName","document","type","text","placeholder","Ced\xfala/DNI",1,"form-control"],["class","form-text text-danger",4,"ngIf"],["formControlName","firstName","type","text","placeholder","Nombres",1,"form-control"],["formControlName","lastName","type","text","placeholder","Apellidos",1,"form-control"],["formControlName","licence","type","text","placeholder","Licencia de conducir",1,"form-control"],["formControlName","category","type","text","placeholder","Categoria",1,"form-control"],[1,"d-grid","gap-2"],["class","btn btn-primary  px-5","type","submit",3,"disabled",4,"ngIf"],["class","btn btn-outline-primary  px-5","disabled","",4,"ngIf"],[1,"mb-0"],["routerLink","/auth/login",1,"fw-bold"],[1,"form-text","text-danger"],["type","submit",1,"btn","btn-primary","px-5",3,"disabled"],[3,"icon"],["disabled","",1,"btn","btn-outline-primary","px-5"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"div",4),t.TgZ(5,"div",5),t.TgZ(6,"div",6),t._UZ(7,"img",7),t.qZA(),t.TgZ(8,"h4",8),t._uU(9,"Me registrar\xe9"),t.qZA(),t.qZA(),t.TgZ(10,"form",9),t.NdJ("submit",function(){return n.register()}),t.TgZ(11,"div",6),t._UZ(12,"input",10),t.YNc(13,B,2,1,"span",11),t.qZA(),t.TgZ(14,"div",6),t._UZ(15,"input",12),t.YNc(16,F,2,0,"span",11),t.qZA(),t.TgZ(17,"div",6),t._UZ(18,"input",13),t.YNc(19,Y,2,0,"span",11),t.qZA(),t.TgZ(20,"div",6),t._UZ(21,"input",14),t.YNc(22,L,2,0,"span",11),t.qZA(),t.TgZ(23,"div",6),t._UZ(24,"input",15),t.YNc(25,w,2,0,"span",11),t.qZA(),t.TgZ(26,"div",16),t.YNc(27,Q,3,3,"button",17),t.YNc(28,j,3,2,"button",18),t.qZA(),t.qZA(),t.qZA(),t.TgZ(29,"div",5),t.TgZ(30,"p",19),t._uU(31," \xbfYa tienes cuenta? "),t.TgZ(32,"a",20),t._uU(33," Ingresar "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o&&(t.xp6(10),t.Q6J("formGroup",n.form),t.xp6(3),t.Q6J("ngIf",n.invalidField("document")),t.xp6(3),t.Q6J("ngIf",n.invalidField("firstName")),t.xp6(3),t.Q6J("ngIf",n.invalidField("lastName")),t.xp6(3),t.Q6J("ngIf",n.invalidField("licence")),t.xp6(3),t.Q6J("ngIf",n.invalidField("category")),t.xp6(2),t.Q6J("ngIf",!n.loading),t.xp6(1),t.Q6J("ngIf",n.loading))},directives:[i._Y,i.JL,i.sg,i.Fj,i.JJ,i.u,p.O5,u.BN,l.yS],styles:[""]}),e})()},{path:"",redirectTo:"login",pathMatch:"full"}]}];let $=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[l.Bz.forChild(D)],l.Bz]}),e})();var d=s(801);let z=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[p.ez,g.zk.forRoot(),u.uH,l.Bz]]}),e})(),G=(()=>{class e{constructor(o){o.addIcons(d.FL8,d.eHv,d.JYN,d.LEp,d.$Wj,d.LM3)}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(u.by))},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[p.ez,$,u.uH,z,i.UX]]}),e})()}}]);