"use strict";(self.webpackChunksocket_pwa=self.webpackChunksocket_pwa||[]).push([[863],{6863:(nt,v,c)=>{c.r(v),c.d(v,{PickingModule:()=>tt});var u=c(9808),b=c(9539),A=c(5898),T=c(2340),t=c(5e3),k=c(3502);let w=(()=>{class i extends A.sk{constructor(){super({url:T.N.wsUrl,options:{}}),this.ioSocket.auth={"x-token":localStorage.getItem("access_token")}}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-picking"]],features:[t.qOj],decls:3,vars:0,consts:[[1,"container-fluid","mt-4"]],template:function(e,n){1&e&&(t._UZ(0,"app-navbar"),t.TgZ(1,"div",0),t._UZ(2,"router-outlet"),t.qZA())},directives:[k.S,b.lC],encapsulation:2}),i})();var r=c(2382),p=c(7579),M=c(520);const{endpoint:U}=T.N,d=`${U}/picking`;let g=(()=>{class i{constructor(e){this.http=e}list(e){return this.http.get(`${d}/list/${e}`)}statusUser(e){return this.http.get(`${d}/user/status/${e}`)}listUserPicking(e){return this.http.get(`${d}/user/list/${e}`)}saveListByUser(e){return this.http.post(`${d}/user`,e)}listDetail(e){return this.http.get(`${d}/${e}`)}update(e,n){return this.http.put(`${d}/${e}`,n)}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(M.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var m=c(1134);function y(i,s){if(1&i&&(t.TgZ(0,"tr",8),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",12),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.qZA()),2&i){const e=s.$implicit,n=s.index;t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Oqu(null==e?null:e.name),t.xp6(2),t.Oqu(null==e?null:e.bottles)}}let S=(()=>{class i{constructor(e,n){this.pickingService=e,this.bsModalRef=n,this.picking="",this.bottles=[]}ngOnInit(){this.getDetail()}onConfirm(){this.bsModalRef.content.onClose.next(!0),this.bsModalRef.hide()}onCancel(){this.bsModalRef.content.onClose.next(!1),this.bsModalRef.hide()}getDetail(){this.pickingService.listDetail(this.picking._id).subscribe(e=>{this.bottles=e.detail.filter(n=>n.bottles>0)})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(g),t.Y36(m.UZ))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-bottle-detail"]],inputs:{picking:"picking"},decls:30,vars:4,consts:[[1,"scrollModal"],[1,"modal-header"],[1,"modal-title","d-flex","justify-content-between","w-100"],[1,"modal-body"],[1,"table-responsive"],[1,"table","table-sm","table-striped","table-bordered"],[1,"fw-bold","text-center","table-primary",2,"font-size","14px"],["class","text-center align-middle",4,"ngFor","ngForOf"],[1,"text-center","align-middle"],["colspan","2"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary","btn-mobile",3,"click"],[1,"text-start"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h5",2),t.TgZ(3,"span"),t._uU(4,"Botellas"),t.qZA(),t.TgZ(5,"span"),t._uU(6),t.qZA(),t.TgZ(7,"span"),t._uU(8),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"div",3),t.TgZ(10,"div",4),t.TgZ(11,"table",5),t.TgZ(12,"thead"),t.TgZ(13,"tr",6),t.TgZ(14,"th"),t._uU(15,"#"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Nombre"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Botellas"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(20,"tbody"),t.YNc(21,y,7,3,"tr",7),t.TgZ(22,"tr",8),t.TgZ(23,"th",9),t._uU(24,"Total"),t.qZA(),t.TgZ(25,"th"),t._uU(26),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(27,"div",10),t.TgZ(28,"button",11),t.NdJ("click",function(){return n.onCancel()}),t._uU(29,"Cerrar"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(6),t.hij("Ruta: ",null==n.picking?null:n.picking.route,""),t.xp6(2),t.hij("Viaje: ",null==n.picking?null:n.picking.travel,""),t.xp6(13),t.Q6J("ngForOf",n.bottles),t.xp6(5),t.Oqu(null==n.picking?null:n.picking.bottles))},directives:[u.sg],styles:[".scrollModal[_ngcontent-%COMP%]{max-width:95vw;max-height:95vh}.table-responsive[_ngcontent-%COMP%]{max-height:75vh}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10}"]}),i})();function P(i,s){if(1&i&&(t.TgZ(0,"tr",8),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",12),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.qZA()),2&i){const e=s.$implicit,n=s.index;t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Oqu(null==e?null:e.name),t.xp6(2),t.Oqu(null==e?null:e.boxes)}}let D=(()=>{class i{constructor(e,n){this.pickingService=e,this.bsModalRef=n,this.picking="",this.boxes=[]}ngOnInit(){this.getDetail()}onConfirm(){this.bsModalRef.content.onClose.next(!0),this.bsModalRef.hide()}onCancel(){this.bsModalRef.content.onClose.next(!1),this.bsModalRef.hide()}getDetail(){this.pickingService.listDetail(this.picking._id).subscribe(e=>{this.boxes=e.detail.filter(n=>n.boxes>0)})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(g),t.Y36(m.UZ))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-box-detail"]],inputs:{picking:"picking"},decls:30,vars:4,consts:[[1,"scrollModal"],[1,"modal-header"],[1,"modal-title","d-flex","justify-content-between","w-100"],[1,"modal-body"],[1,"table-responsive"],[1,"table","table-sm","table-striped","table-bordered"],[1,"fw-bold","text-center","table-primary",2,"font-size","14px"],["class","text-center align-middle",4,"ngFor","ngForOf"],[1,"text-center","align-middle"],["colspan","2"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary","btn-mobile",3,"click"],[1,"text-start"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h5",2),t.TgZ(3,"span"),t._uU(4,"Cajas"),t.qZA(),t.TgZ(5,"span"),t._uU(6),t.qZA(),t.TgZ(7,"span"),t._uU(8),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"div",3),t.TgZ(10,"div",4),t.TgZ(11,"table",5),t.TgZ(12,"thead"),t.TgZ(13,"tr",6),t.TgZ(14,"th"),t._uU(15,"#"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Nombre"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Cajas"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(20,"tbody"),t.YNc(21,P,7,3,"tr",7),t.TgZ(22,"tr",8),t.TgZ(23,"th",9),t._uU(24,"Total"),t.qZA(),t.TgZ(25,"th"),t._uU(26),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(27,"div",10),t.TgZ(28,"button",11),t.NdJ("click",function(){return n.onCancel()}),t._uU(29,"Cerrar"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(6),t.hij("Ruta: ",null==n.picking?null:n.picking.route,""),t.xp6(2),t.hij("Viaje: ",null==n.picking?null:n.picking.travel,""),t.xp6(13),t.Q6J("ngForOf",n.boxes),t.xp6(5),t.Oqu(null==n.picking?null:n.picking.boxes))},directives:[u.sg],styles:[".scrollModal[_ngcontent-%COMP%]{max-width:95vw;max-height:95vh}.table-responsive[_ngcontent-%COMP%]{max-height:75vh}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10}"]}),i})();function O(i,s){if(1&i&&(t.TgZ(0,"tr",8),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",12),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.qZA()),2&i){const e=s.$implicit,n=s.index;t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Oqu(null==e?null:e.name),t.xp6(2),t.Oqu(null==e?null:e.packages)}}let N=(()=>{class i{constructor(e,n){this.pickingService=e,this.bsModalRef=n,this.picking="",this.packages=[]}ngOnInit(){this.getDetail()}onConfirm(){this.bsModalRef.content.onClose.next(!0),this.bsModalRef.hide()}onCancel(){this.bsModalRef.content.onClose.next(!1),this.bsModalRef.hide()}getDetail(){this.pickingService.listDetail(this.picking._id).subscribe(e=>{this.packages=e.detail.filter(n=>n.packages>0)})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(g),t.Y36(m.UZ))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-package-detail"]],inputs:{picking:"picking"},decls:30,vars:4,consts:[[1,"scrollModal"],[1,"modal-header"],[1,"modal-title","d-flex","justify-content-between","w-100"],[1,"modal-body"],[1,"table-responsive"],[1,"table","table-sm","table-striped","table-bordered"],[1,"fw-bold","text-center","table-primary",2,"font-size","14px"],["class","text-center align-middle",4,"ngFor","ngForOf"],[1,"text-center","align-middle"],["colspan","2"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary","btn-mobile",3,"click"],[1,"text-start"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h5",2),t.TgZ(3,"span"),t._uU(4,"Paquetes"),t.qZA(),t.TgZ(5,"span"),t._uU(6),t.qZA(),t.TgZ(7,"span"),t._uU(8),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"div",3),t.TgZ(10,"div",4),t.TgZ(11,"table",5),t.TgZ(12,"thead"),t.TgZ(13,"tr",6),t.TgZ(14,"th"),t._uU(15,"#"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Nombre"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Paquetes"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(20,"tbody"),t.YNc(21,O,7,3,"tr",7),t.TgZ(22,"tr",8),t.TgZ(23,"th",9),t._uU(24,"Total"),t.qZA(),t.TgZ(25,"th"),t._uU(26),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(27,"div",10),t.TgZ(28,"button",11),t.NdJ("click",function(){return n.onCancel()}),t._uU(29,"Cerrar"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(6),t.hij("Ruta: ",null==n.picking?null:n.picking.route,""),t.xp6(2),t.hij("Viaje: ",null==n.picking?null:n.picking.travel,""),t.xp6(13),t.Q6J("ngForOf",n.packages),t.xp6(5),t.Oqu(null==n.picking?null:n.picking.packages))},directives:[u.sg],styles:[".scrollModal[_ngcontent-%COMP%]{max-width:95vw;max-height:95vh}.table-responsive[_ngcontent-%COMP%]{max-height:75vh}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10}"]}),i})();var q=c(7556),x=c(8620),R=c(3722),Z=c(9444);function I(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"a",16),t.NdJ("click",function(){return t.CHM(e),t.oxw().closeModal()}),t._uU(1,"Cerrar"),t.qZA()}}function Y(i,s){if(1&i&&(t.TgZ(0,"h3",17),t._uU(1),t.ALo(2,"uppercase"),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij("",t.lcZ(2,1,e.message)," !!!")}}function J(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"label",18),t.TgZ(1,"input",19),t.NdJ("click",function(){const o=t.CHM(e).$implicit;return t.oxw().onCheck(o)}),t.qZA(),t._uU(2),t.qZA()}if(2&i){const e=s.$implicit;t.xp6(2),t.AsE(" ",e.route," - ",e.travel," ")}}function F(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div",20),t.TgZ(1,"a",21),t.NdJ("click",function(){return t.CHM(e),t.oxw().confirmSave()}),t._uU(2,"Guardar"),t.qZA(),t.qZA()}}const H=function(){return["fas","sync-alt"]};let $=(()=>{class i{constructor(e,n,l,o,a,h,et){this.pickingService=e,this.datePipe=n,this.fb=l,this.authService=o,this.common=a,this.bsModalRef=h,this.wsService=et,this.listLength=0,this.list=[],this.listChecked=[],this.title="Seleccionar Rutas",this.user=this.authService.user,this.message="",this.form=this.fb.group({date:[""]})}ngOnInit(){this.wsService.emit("picking"),this.formatedDate=this.datePipe.transform(Date.now(),"yyyy-MM-dd"),this.form.get("date").patchValue(this.formatedDate),this.suscription$=this.wsService.listen("to-picking").subscribe(()=>this.getList())}watch(){this.wsService.emit("picking"),this.list=[]}getList(){this.pickingService.listUserPicking(this.form.get("date").value).subscribe(e=>{this.list=e,this.message="",this.list.forEach(n=>{n.checked=!1})},e=>{this.message=e.error.message})}onCheck(e){e.checked=!e.checked}confirmSave(){const e=this;this.common.showConfirmSave("GUARDAR","Recuerda que una vez guardado no podr\xe1s modificar los datos. \xbfDeseas continuar?",function(l){l.isConfirmed&&(e.saveAllChecked(),e.common.showToast(`Se han guardado ${e.listChecked.length} datos correctamente.`))})}saveAllChecked(){this.listChecked=[],this.list.forEach(e=>{e.checked&&(delete e.checked,e.user=this.user.uid,this.listChecked.push(e))}),this.pickingService.saveListByUser(this.listChecked).subscribe(e=>{this.wsService.emit("picking")}),this.bsModalRef.hide()}ngOnDestroy(){this.suscription$.unsubscribe()}closeModal(){console.log("close"),this.bsModalRef.hide()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(g),t.Y36(u.uU),t.Y36(r.qu),t.Y36(q.e),t.Y36(x.v_),t.Y36(m.UZ),t.Y36(R.i))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-select-routes"]],inputs:{listLength:"listLength"},decls:19,vars:8,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["class","btn btn-danger",3,"click",4,"ngIf"],[1,"modal-body"],[1,"row"],[1,"col-md-3","d-flex",3,"formGroup"],["type","date","formControlName","date",1,"form-control","mr-2"],["type","button",1,"btn","btn-sm","btn-danger","ms-1",3,"click"],[1,"col-md-8"],[1,"col-md-1","d-flex","justify-content-center"],[1,"btn","btn-link",3,"click"],[3,"icon"],[1,"border","mt-4"],["class","text-center mt-4 fw-bold",4,"ngIf"],["class","m-3",4,"ngFor","ngForOf"],["class","text-center mt-4",4,"ngIf"],[1,"btn","btn-danger",3,"click"],[1,"text-center","mt-4","fw-bold"],[1,"m-3"],["type","checkbox",1,"form-check-input","largerCheckBox","me-2","mt-0","fw-bold",3,"click"],[1,"text-center","mt-4"],[1,"btn","btn-success",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"h4",1),t._uU(2),t.qZA(),t.YNc(3,I,2,0,"a",2),t.qZA(),t.TgZ(4,"div",3),t.TgZ(5,"div",4),t.TgZ(6,"div",5),t._UZ(7,"input",6),t.TgZ(8,"button",7),t.NdJ("click",function(){return n.watch()}),t._uU(9,"Ver"),t.qZA(),t.qZA(),t._UZ(10,"div",8),t.TgZ(11,"div",9),t.TgZ(12,"button",10),t.NdJ("click",function(){return n.watch()}),t._UZ(13,"fa-icon",11),t.qZA(),t.qZA(),t.qZA(),t.TgZ(14,"div",12),t.YNc(15,Y,3,3,"h3",13),t.YNc(16,J,3,2,"label",14),t._UZ(17,"br"),t.qZA(),t.YNc(18,F,3,0,"div",15),t.qZA()),2&e&&(t.xp6(2),t.Oqu(n.title),t.xp6(1),t.Q6J("ngIf",n.listLength>0),t.xp6(3),t.Q6J("formGroup",n.form),t.xp6(7),t.Q6J("icon",t.DdM(7,H)),t.xp6(2),t.Q6J("ngIf",n.message),t.xp6(1),t.Q6J("ngForOf",n.list),t.xp6(2),t.Q6J("ngIf",n.list.length>0))},directives:[u.O5,r.JL,r.sg,r.Fj,r.JJ,r.u,Z.BN,u.sg],pipes:[u.gd],styles:["input.largerCheckBox[_ngcontent-%COMP%]{width:25px;height:25px}  .modal-dialog{max-width:95vw;max-height:95vh;width:1500px;height:800px}  .modal-content{height:100%}"]}),i})();function j(i,s){if(1&i&&(t.TgZ(0,"tr",8),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",12),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.qZA()),2&i){const e=s.$implicit,n=s.index;t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Oqu(null==e?null:e.name),t.xp6(2),t.Oqu(null==e?null:e.units)}}let L=(()=>{class i{constructor(e,n){this.pickingService=e,this.bsModalRef=n,this.picking="",this.units=[]}ngOnInit(){this.getDetail()}onConfirm(){this.bsModalRef.content.onClose.next(!0),this.bsModalRef.hide()}onCancel(){this.bsModalRef.content.onClose.next(!1),this.bsModalRef.hide()}getDetail(){this.pickingService.listDetail(this.picking._id).subscribe(e=>{this.units=e.detail.filter(n=>n.units>0)})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(g),t.Y36(m.UZ))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-unit-detail"]],inputs:{picking:"picking"},decls:30,vars:4,consts:[[1,"scrollModal"],[1,"modal-header"],[1,"modal-title","d-flex","justify-content-between","w-100"],[1,"modal-body"],[1,"table-responsive"],[1,"table","table-sm","table-striped","table-bordered"],[1,"fw-bold","text-center","table-primary",2,"font-size","14px"],["class","text-center align-middle",4,"ngFor","ngForOf"],[1,"text-center","align-middle"],["colspan","2"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary","btn-mobile",3,"click"],[1,"text-start"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h5",2),t.TgZ(3,"span"),t._uU(4,"Unidades"),t.qZA(),t.TgZ(5,"span"),t._uU(6),t.qZA(),t.TgZ(7,"span"),t._uU(8),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"div",3),t.TgZ(10,"div",4),t.TgZ(11,"table",5),t.TgZ(12,"thead"),t.TgZ(13,"tr",6),t.TgZ(14,"th"),t._uU(15,"#"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Nombre"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Unidades"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(20,"tbody"),t.YNc(21,j,7,3,"tr",7),t.TgZ(22,"tr",8),t.TgZ(23,"th",9),t._uU(24,"Total"),t.qZA(),t.TgZ(25,"th"),t._uU(26),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(27,"div",10),t.TgZ(28,"button",11),t.NdJ("click",function(){return n.onCancel()}),t._uU(29,"Cerrar"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(6),t.hij("Ruta: ",null==n.picking?null:n.picking.route,""),t.xp6(2),t.hij("Viaje: ",null==n.picking?null:n.picking.travel,""),t.xp6(13),t.Q6J("ngForOf",n.units),t.xp6(5),t.Oqu(null==n.picking?null:n.picking.units))},directives:[u.sg],styles:[".scrollModal[_ngcontent-%COMP%]{max-width:95vw;max-height:95vh}.table-responsive[_ngcontent-%COMP%]{max-height:75vh}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10}"]}),i})();function B(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(e);const l=t.oxw(),o=l.$implicit,a=l.index;return t.oxw().confirmStart(o,a)}),t._uU(1," Inicio "),t.qZA()}}function G(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"button",26),t.NdJ("click",function(){t.CHM(e);const l=t.oxw(),o=l.$implicit,a=l.index;return t.oxw().confirmFinish(o,a)}),t._uU(1," Fin "),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.Q6J("disabled",void 0!==e.value.endTime)}}const C=function(){return{}};function Q(i,s){if(1&i&&(t.TgZ(0,"h5",27),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit,n=t.oxw();t.Q6J("ngStyle",e.value.startTime?n.getColor(e):t.DdM(2,C)),t.xp6(1),t.hij(" ",null==e||null==e.value?null:e.value.currentTime," ")}}const f=function(){return["fas","eye"]},z=function(){return{"background-color":"#ff6961"}};function V(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"tr",19),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td",11),t._uU(10),t.qZA(),t.TgZ(11,"td",11),t.TgZ(12,"fa-icon",20),t.NdJ("click",function(){const o=t.CHM(e).$implicit;return t.oxw().boxDetail(o)}),t.qZA(),t.qZA(),t.TgZ(13,"td",12),t._uU(14),t.qZA(),t.TgZ(15,"td",12),t.TgZ(16,"fa-icon",20),t.NdJ("click",function(){const o=t.CHM(e).$implicit;return t.oxw().bottleDetail(o)}),t.qZA(),t.qZA(),t.TgZ(17,"td",13),t._uU(18),t.qZA(),t.TgZ(19,"td",13),t.TgZ(20,"fa-icon",20),t.NdJ("click",function(){const o=t.CHM(e).$implicit;return t.oxw().packageDetail(o)}),t.qZA(),t.qZA(),t.TgZ(21,"td",14),t._uU(22),t.qZA(),t.TgZ(23,"td",14),t.TgZ(24,"fa-icon",20),t.NdJ("click",function(){const o=t.CHM(e).$implicit;return t.oxw().unitDetail(o)}),t.qZA(),t.qZA(),t.TgZ(25,"td"),t.YNc(26,B,2,0,"button",21),t.YNc(27,G,2,1,"button",22),t.qZA(),t.TgZ(28,"td",23),t.YNc(29,Q,2,3,"h5",24),t.qZA(),t.TgZ(30,"td"),t._uU(31),t.qZA(),t.qZA()}if(2&i){const e=s.$implicit,n=s.index;t.xp6(2),t.Oqu(n+1),t.xp6(2),t.Oqu(null==e||null==e.value?null:e.value.plaque),t.xp6(2),t.Oqu(null==e||null==e.value?null:e.value.route),t.xp6(2),t.Oqu(null==e||null==e.value?null:e.value.travel),t.xp6(2),t.Oqu(null==e||null==e.value?null:e.value.boxes),t.xp6(2),t.Q6J("icon",t.DdM(17,f)),t.xp6(2),t.Oqu(null==e||null==e.value?null:e.value.bottles),t.xp6(2),t.Q6J("icon",t.DdM(18,f)),t.xp6(2),t.Oqu(null==e||null==e.value?null:e.value.packages),t.xp6(2),t.Q6J("icon",t.DdM(19,f)),t.xp6(2),t.Oqu(null==e||null==e.value?null:e.value.units),t.xp6(2),t.Q6J("icon",t.DdM(20,f)),t.xp6(2),t.Q6J("ngIf",!e.value.startTime&&!e.value.endTime),t.xp6(1),t.Q6J("ngIf",e.value.startTime),t.xp6(1),t.Q6J("ngStyle",null!=e&&null!=e.value&&e.value.start?t.DdM(21,z):t.DdM(22,C)),t.xp6(1),t.Q6J("ngIf",e.value.startTime),t.xp6(2),t.Oqu(null==e||null==e.value?null:e.value.totalUnits)}}const E=function(){return["fas","clock"]},X=[{path:"",component:w,children:[{path:"enlistment",component:(()=>{class i{constructor(e,n,l,o,a,h){this.fb=e,this.pickingService=n,this.authService=l,this.modalService=o,this.datePipe=a,this.common=h,this.user=this.authService.user,this.prod=215,this.form=this.fb.group({items:this.fb.array([]),date:[""]})}ngOnInit(){this.formatedDate=this.datePipe.transform(Date.now(),"yyyy-MM-dd"),this.form.get("date").patchValue(this.formatedDate),this.getStatus()}countdown(e,n){const l=new Date(n).getTime(),a=(new Date).getTime()-l;e.hours=Math.floor(a%864e5/36e5),e.minutes=Math.floor(a%36e5/6e4),e.seconds=Math.floor(a%6e4/1e3),e.currentTime=`${e.hours<10?"0"+e.hours:e.hours}:${e.minutes<10?"0"+e.minutes:e.minutes}:${e.seconds<10?"0"+e.seconds:e.seconds}`||"00:00:00"}getHourLimit(e,n,l){e.hoursLimit=Math.round(n/l*100)/100}getDecimal(e){if(Number.isInteger(e))return 0;const n=e.toString().split(".")[1];return Number(n)}getCorrectTime(e,n){let l=Math.trunc(n),o=this.getDecimal(n);o=Math.round(60*o/100),e.correctHour=l,e.correctMinute=o}getCorrectTimeGreen(e,n){let l=Math.trunc(n),o=this.getDecimal(n);o=Math.round(60*o/100),e.correctHourGreen=l,e.correctMinuteGreen=o}getCorrectTimeYellow(e,n){let l=Math.trunc(n),o=this.getDecimal(n);o=Math.round(60*o/100),e.correctHourYellow=l,e.correctMinuteYellow=o}getColor(e){const n=Math.round(90*e.value.hoursLimit/100*100)/100,l=Math.round(100*e.value.hoursLimit/100*100)/100;return this.getCorrectTime(e.value,e.value.hoursLimit),this.getCorrectTimeGreen(e.value,n),this.getCorrectTimeYellow(e.value,l),e.value.hours>=e.value.correctHourGreen&&e.value.minutes>=e.value.correctMinuteGreen&&e.value.hours<=e.value.correctHourYellow&&e.value.minutes<=e.value.correctMinuteYellow?{"background-color":"#ffff00",color:"#000"}:e.value.hours>=e.value.correctHourYellow&&e.value.minutes>=e.value.correctMinuteYellow?{"background-color":"#ff0000",color:"#fff"}:{"background-color":"#00b050",color:"#fff"}}getStatus(){this.pickingService.statusUser(this.form.get("date").value).subscribe(e=>{e.ok?this.getPickings():e.ok||this.openModal()})}openModal(){this.subCategoryRef=this.modalService.show($,{class:"modal-dialog-centered modal-lg",keyboard:!1,backdrop:"static",initialState:{listLength:this.form.get("items").value.length}}),this.modalService.onHide.subscribe(e=>{this.getPickings()})}getPickings(){this.pickingService.list(this.form.get("date").value).subscribe(e=>{this.form.setControl("items",this.fb.array([]));const n=this.form.get("items");let l;e&&e.length>0&&Object.keys(e).forEach(o=>{n.push(this.fb.group({_id:new r.NI({value:e[o]._id,disabled:!0}),route:new r.NI({value:e[o].route,disabled:!0}),travel:new r.NI({value:e[o].travel,disabled:!0}),plaque:new r.NI({value:e[o].plaque,disabled:!0}),boxes:new r.NI({value:e[o].boxes,disabled:!0}),bottles:new r.NI({value:e[o].bottles,disabled:!0}),packages:new r.NI({value:e[o].packages,disabled:!0}),units:new r.NI({value:e[o].units,disabled:!0}),startTime:new r.NI({value:e[o].startTime,disabled:!0}),endTime:new r.NI({value:e[o].endTime,disabled:!0}),totalUnits:new r.NI({value:e[o].totalUnits,disabled:!0}),preparer:new r.NI({value:this.user.uid,disabled:!0}),start:new r.NI({value:e[o].start,disabled:!0}),currentTime:new r.NI({value:e[o].currentTime||"00:00:00",disabled:!0}),hoursLimit:new r.NI({value:e[o].hoursLimit||0,disabled:!0}),correctHour:new r.NI({value:e[o].correctHour||0,disabled:!0}),correctMinute:new r.NI({value:e[o].correctMinute||0,disabled:!0}),correctHourGreen:new r.NI({value:e[o].correctHourGreen||0,disabled:!0}),correctMinuteGreen:new r.NI({value:e[o].correctMinuteGreen||0,disabled:!0}),correctHourYellow:new r.NI({value:e[o].correctHourYellow||0,disabled:!0}),correctMinuteYellow:new r.NI({value:e[o].correctMinuteYellow||0,disabled:!0}),hours:new r.NI({value:e[o].hours||0,disabled:!0}),minutes:new r.NI({value:e[o].minutes||0,disabled:!0}),seconds:new r.NI({value:e[o].seconds||0,disabled:!0})}))}),n.controls.forEach((o,a)=>{l=setInterval(()=>{void 0===o.value.endTime&&(this.countdown(o.value,o.value.startTime),this.getHourLimit(o.value,o.value.boxes,this.prod),this.getColor(o),void 0!==o.value.endTime&&clearInterval(l))},250)})})}confirmStart(e,n){const l=this;this.common.showConfirmStart("CONTAR","Recuerda que una vez iniciado el conteo no podr\xe1s cambiarlo. \xbfDeseas continuar? ",function(a){a.isConfirmed&&l.start(e,n)})}confirmFinish(e,n){const l=this;this.common.showConfirmEnd("FINALIZAR","Recuerda que una vez finalizado el conteo no podr\xe1s cambiarlo. \xbfDeseas continuar? ",function(a){a.isConfirmed&&l.finish(e,n)})}start(e,n){let l;this.form.get("items").controls[n].patchValue({startTime:new Date,start:!0}),this.pickingService.update(e.value._id,this.form.get("items").controls[n].value).subscribe(),l=setInterval(()=>{void 0===e.value.endTime&&(this.countdown(e.value,e.value.startTime),this.getHourLimit(e.value,e.value.boxes,this.prod),this.getColor(e),void 0!==e.value.endTime&&clearInterval(l))},250)}finish(e,n){this.form.get("items").controls[n].patchValue({hoursLimit:e.value.hoursLimit,currentTime:e.value.currentTime,endTime:new Date,start:!1,correctHour:e.value.correctHour,correctMinute:e.value.correctMinute,correctHourGreen:e.value.correctHourGreen,correctMinuteGreen:e.value.correctMinuteGreen,correctHourYellow:e.value.correctHourYellow,correctMinuteYellow:e.value.correctMinuteYellow,hours:e.value.hours,minutes:e.value.minutes,seconds:e.value.seconds}),this.pickingService.update(e.value._id,this.form.get("items").controls[n].value).subscribe(),console.log(this.form.get("items").controls[n].value)}boxDetail(e){this.subCategoryRef=this.modalService.show(D,{class:"modal-dialog-centered modal-lg",initialState:{picking:e.value}}),this.subCategoryRef.content.onClose=new p.x}bottleDetail(e){this.subCategoryRef=this.modalService.show(S,{class:"modal-dialog-centered modal-lg",initialState:{picking:e.value}}),this.subCategoryRef.content.onClose=new p.x}packageDetail(e){this.subCategoryRef=this.modalService.show(N,{class:"modal-dialog-centered modal-lg",initialState:{picking:e.value}}),this.subCategoryRef.content.onClose=new p.x}unitDetail(e){this.subCategoryRef=this.modalService.show(L,{class:"modal-dialog-centered modal-lg",initialState:{picking:e.value}}),this.subCategoryRef.content.onClose=new p.x}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(r.qu),t.Y36(g),t.Y36(q.e),t.Y36(m.tT),t.Y36(u.uU),t.Y36(x.v_))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-picking"]],decls:46,vars:5,consts:[[1,"container-fluid"],[1,"row"],[1,"col-md-2","d-flex",3,"formGroup"],["type","date","formControlName","date",1,"form-control","mr-2"],["type","button",1,"btn","btn-sm","btn-danger","ms-1",3,"click"],[1,"col-md-9","mb-2"],[1,"col-md-1"],["type","button",1,"btn","btn-sm","btn-primary","ms-1",3,"click"],[1,"table-responsive","mt-3"],[1,"table","table-sm","table-striped","table-bordered",3,"formGroup"],[1,"fw-bold","text-center","table-primary",2,"font-size","14px"],[2,"background-color","#f7dae5"],[2,"background-color","#e2f0cb"],[2,"background-color","#c3e2e6"],[2,"background-color","#d0cce0"],[2,"width","62px"],["size","lg",3,"icon"],[2,"width","200px"],["class","text-center align-middle",4,"ngFor","ngForOf"],[1,"text-center","align-middle"],["size","lg",1,"eye",3,"icon","click"],["type","button","class","btn btn-primary btn-sm",3,"click",4,"ngIf"],["type","button","class","btn btn-secondary btn-sm",3,"disabled","click",4,"ngIf"],[1,"p-1",3,"ngStyle"],["class","mb-0 fw-bold text-center","style","padding: 10px 0",3,"ngStyle",4,"ngIf"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],["type","button",1,"btn","btn-secondary","btn-sm",3,"disabled","click"],[1,"mb-0","fw-bold","text-center",2,"padding","10px 0",3,"ngStyle"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"form",2),t._UZ(3,"input",3),t.TgZ(4,"button",4),t.NdJ("click",function(){return n.getPickings()}),t._uU(5,"Ver"),t.qZA(),t.qZA(),t._UZ(6,"div",5),t.TgZ(7,"div",6),t.TgZ(8,"button",7),t.NdJ("click",function(){return n.openModal()}),t._uU(9,"Seleccionar rutas"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"div",8),t.TgZ(11,"table",9),t.TgZ(12,"thead"),t.TgZ(13,"tr",10),t.TgZ(14,"th"),t._uU(15,"#"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Placa"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Ruta"),t.qZA(),t.TgZ(20,"th"),t._uU(21,"Viaje"),t.qZA(),t.TgZ(22,"th",11),t._uU(23,"Cajas"),t.qZA(),t.TgZ(24,"th",11),t._uU(25,"Ver"),t.qZA(),t.TgZ(26,"th",12),t._uU(27,"Botellas"),t.qZA(),t.TgZ(28,"th",12),t._uU(29,"Ver"),t.qZA(),t.TgZ(30,"th",13),t._uU(31,"Paquetes"),t.qZA(),t.TgZ(32,"th",13),t._uU(33,"Ver"),t.qZA(),t.TgZ(34,"th",14),t._uU(35,"Unidades"),t.qZA(),t.TgZ(36,"th",14),t._uU(37,"Ver"),t.qZA(),t.TgZ(38,"th",15),t._UZ(39,"fa-icon",16),t.qZA(),t.TgZ(40,"th",17),t._uU(41,"Tiempo"),t.qZA(),t.TgZ(42,"th"),t._uU(43,"Total Unidades"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(44,"tbody"),t.YNc(45,V,32,23,"tr",18),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e){let l;t.xp6(2),t.Q6J("formGroup",n.form),t.xp6(9),t.Q6J("formGroup",n.form),t.xp6(28),t.Q6J("icon",t.DdM(4,E)),t.xp6(6),t.Q6J("ngForOf",null==(l=n.form.get("items"))?null:l.controls)}},directives:[r._Y,r.JL,r.sg,r.Fj,r.JJ,r.u,Z.BN,u.sg,u.O5,u.PC],styles:[".eye[_ngcontent-%COMP%]{cursor:pointer}.eye[_ngcontent-%COMP%]:hover{color:#fff}"]}),i})()},{path:"",redirectTo:"enlistment",pathMatch:"full"}]}];let K=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[b.Bz.forChild(X)],b.Bz]}),i})();var W=c(6802),_=c(801);let tt=(()=>{class i{constructor(e){e.addIcons(_.SZw,_.Mdf,_.d8e)}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Z.by))},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[u.ez,K,W.m,r.UX,Z.uH]]}),i})()}}]);