"use strict";(self.webpackChunksocket_pwa=self.webpackChunksocket_pwa||[]).push([[931],{5931:(W,g,r)=>{r.r(g),r.d(g,{ForkliftModule:()=>$});var d=r(9808),m=r(9539),t=r(5e3),f=r(2340),p=r(520);const{endpoint:A}=f.N,u=`${A}/control`;let Z=(()=>{class e{constructor(n){this.http=n}getUnloadTruck(){return this.http.get(`${u}/registry/unload-truck`)}getLoadTruck(){return this.http.get(`${u}/registry/load-truck`)}getMyLift(){return this.http.get(`${u}/lift/mylift`)}updateLift(n,o){return this.http.put(`${u}/lift/${n}/update`,o)}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(p.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var T=r(1134);const{endpoint:h}=f.N,v=`${h}/control`;let k=(()=>{class e{constructor(n){this.http=n}updateRegistry(n,o){return this.http.put(`${v}/registry/${n}/update`,o)}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(p.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var x=r(2290),y=r(7423),_=r(9444);function C(e,c){1&e&&(t.TgZ(0,"small",14),t._uU(1,"El cami\xf3n no ha ingresado a\xfan"),t.qZA())}function b(e,c){if(1&e&&(t.TgZ(0,"small",14),t._uU(1),t.qZA()),2&e){const n=t.oxw(3);t.xp6(1),t.hij("","DESCARGA"===n.registry.state?"Descargar":"Cargar"," cami\xf3n")}}function q(e,c){if(1&e&&(t.TgZ(0,"h3"),t._uU(1),t.YNc(2,C,2,0,"small",13),t.YNc(3,b,2,1,"small",13),t.qZA()),2&e){const n=t.oxw(2);t.xp6(1),t.hij("",n.title,"| "),t.xp6(1),t.Q6J("ngIf",!(null!=n.registry&&n.registry.checkInTime)),t.xp6(1),t.Q6J("ngIf",null==n.registry?null:n.registry.checkInTime)}}const l=function(){return["fas","check"]};function U(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"div",22),t.TgZ(1,"button",23),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(4),s=t.MAs(7);return i.confirmModal(s)}),t._UZ(2,"fa-icon",3),t._uU(3," INICIAR DESCARGA "),t.qZA(),t.qZA()}2&e&&(t.xp6(2),t.Q6J("icon",t.DdM(1,l)))}function M(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"small"),t._uU(2,"Hora inicio"),t.qZA(),t.TgZ(3,"h4",24),t._uU(4),t.ALo(5,"date"),t.qZA(),t.TgZ(6,"h3",25),t._uU(7,"DESCARGANDO..."),t.qZA(),t.TgZ(8,"button",26),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(4),s=t.MAs(9);return i.confirmModal(s)}),t._UZ(9,"fa-icon",3),t._uU(10," FINALIZAR DESCARGA "),t.qZA(),t.qZA()}if(2&e){const n=t.oxw(4);t.xp6(4),t.Oqu(t.xi3(5,2,n.registry.unloadStartTime,"HH:mm")),t.xp6(5),t.Q6J("icon",t.DdM(5,l))}}function N(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"div",22),t.TgZ(1,"button",23),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(4),s=t.MAs(11);return i.confirmModal(s)}),t._UZ(2,"fa-icon",3),t._uU(3," INICIAR CARGA "),t.qZA(),t.qZA()}2&e&&(t.xp6(2),t.Q6J("icon",t.DdM(1,l)))}function R(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"small"),t._uU(2,"Hora inicio"),t.qZA(),t.TgZ(3,"h4",24),t._uU(4),t.ALo(5,"date"),t.qZA(),t.TgZ(6,"h3",25),t._uU(7,"CARGANDO..."),t.qZA(),t.TgZ(8,"button",26),t.NdJ("click",function(){t.CHM(n);const i=t.oxw(4),s=t.MAs(13);return i.confirmModal(s)}),t._UZ(9,"fa-icon",3),t._uU(10," FINALIZAR CARGA "),t.qZA(),t.qZA()}if(2&e){const n=t.oxw(4);t.xp6(4),t.Oqu(t.xi3(5,2,n.registry.loadStartTime,"HH:mm")),t.xp6(5),t.Q6J("icon",t.DdM(5,l))}}const J=function(){return["fas","truck"]};function F(e,c){if(1&e&&(t.TgZ(0,"div",17),t.TgZ(1,"div",18),t._UZ(2,"fa-icon",19),t.TgZ(3,"p",20),t.TgZ(4,"small"),t._uU(5,"Cami\xf3n"),t.qZA(),t.qZA(),t.TgZ(6,"h4"),t._uU(7),t.TgZ(8,"small",14),t._uU(9),t.qZA(),t.qZA(),t.TgZ(10,"h5"),t._uU(11),t.qZA(),t.YNc(12,U,4,2,"div",21),t.YNc(13,M,11,6,"div",4),t.YNc(14,N,4,2,"div",21),t.YNc(15,R,11,6,"div",4),t.qZA(),t.qZA()),2&e){const n=t.oxw(3);t.xp6(2),t.Q6J("icon",t.DdM(8,J)),t.xp6(5),t.hij("",n.registry.truck.plaque," "),t.xp6(2),t.Oqu(n.registry.truck.type.name),t.xp6(2),t.Oqu(n.registry.bay.name),t.xp6(1),t.Q6J("ngIf","DESCARGA"===n.registry.state),t.xp6(1),t.Q6J("ngIf","DESCARGANDO"===n.registry.state),t.xp6(1),t.Q6J("ngIf","CARGA"===n.registry.state),t.xp6(1),t.Q6J("ngIf","CARGANDO"===n.registry.state)}}function S(e,c){if(1&e&&(t.TgZ(0,"div",15),t.YNc(1,F,16,9,"div",16),t.qZA()),2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("ngIf",null==n.registry?null:n.registry.checkInTime)}}const D=function(){return["fas","sync-alt"]};function I(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"button",10),t.NdJ("click",function(){return t.CHM(n),t.oxw().getUnloadTruck()}),t._UZ(2,"fa-icon",3),t.qZA(),t.YNc(3,q,4,3,"h3",4),t._UZ(4,"hr"),t.TgZ(5,"p",11),t._uU(6),t.ALo(7,"date"),t.qZA(),t.YNc(8,S,2,1,"div",12),t.qZA()}if(2&e){const n=t.oxw();t.xp6(2),t.Q6J("icon",t.DdM(7,D)),t.xp6(1),t.Q6J("ngIf",!n.myLift.isFree),t.xp6(3),t.Oqu(t.xi3(7,4,n.date,"dd/MM/YY")),t.xp6(2),t.Q6J("ngIf",!n.myLift.isFree)}}function w(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"div",27),t.TgZ(1,"h5",28),t._uU(2,"Iniciar descarga"),t.qZA(),t.TgZ(3,"button",29),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return null==i.modalRef?null:i.modalRef.hide()}),t.qZA(),t.qZA(),t.TgZ(4,"div",30),t.TgZ(5,"p"),t._uU(6,"Confirme el inicio de descarga del veh\xedculo"),t.qZA(),t.TgZ(7,"button",31),t.NdJ("click",function(){return t.CHM(n),t.oxw().unloadTruck()}),t._UZ(8,"fa-icon",3),t._uU(9," Confirmar"),t.qZA(),t.TgZ(10,"button",32),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return null==i.modalRef?null:i.modalRef.hide()}),t._uU(11,"Cancelar"),t.qZA(),t.qZA()}2&e&&(t.xp6(8),t.Q6J("icon",t.DdM(1,l)))}function L(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"div",27),t.TgZ(1,"h5",28),t._uU(2,"Finalizar descarga"),t.qZA(),t.TgZ(3,"button",29),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return null==i.modalRef?null:i.modalRef.hide()}),t.qZA(),t.qZA(),t.TgZ(4,"div",30),t.TgZ(5,"p"),t._uU(6,"Confirme que se ha finalizado la descarga del veh\xedculo"),t.qZA(),t.TgZ(7,"button",31),t.NdJ("click",function(){return t.CHM(n),t.oxw().unloadEndTruck()}),t._UZ(8,"fa-icon",3),t._uU(9," Confirmar"),t.qZA(),t.TgZ(10,"button",32),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return null==i.modalRef?null:i.modalRef.hide()}),t._uU(11,"Cancelar"),t.qZA(),t.qZA()}2&e&&(t.xp6(8),t.Q6J("icon",t.DdM(1,l)))}function O(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"div",27),t.TgZ(1,"h5",28),t._uU(2,"Iniciar carga"),t.qZA(),t.TgZ(3,"button",29),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return null==i.modalRef?null:i.modalRef.hide()}),t.qZA(),t.qZA(),t.TgZ(4,"div",30),t.TgZ(5,"p"),t._uU(6,"Confirme el inicio de carga del veh\xedculo"),t.qZA(),t.TgZ(7,"button",31),t.NdJ("click",function(){return t.CHM(n),t.oxw().loadTruck()}),t._UZ(8,"fa-icon",3),t._uU(9," Confirmar"),t.qZA(),t.TgZ(10,"button",32),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return null==i.modalRef?null:i.modalRef.hide()}),t._uU(11,"Cancelar"),t.qZA(),t.qZA()}2&e&&(t.xp6(8),t.Q6J("icon",t.DdM(1,l)))}function E(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"div",27),t.TgZ(1,"h5",28),t._uU(2,"Finalizar carga"),t.qZA(),t.TgZ(3,"button",29),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return null==i.modalRef?null:i.modalRef.hide()}),t.qZA(),t.qZA(),t.TgZ(4,"div",30),t.TgZ(5,"p"),t._uU(6,"Confirme que se ha finalizado la carga del veh\xedculo"),t.qZA(),t.TgZ(7,"button",31),t.NdJ("click",function(){return t.CHM(n),t.oxw().loadEndTruck()}),t._UZ(8,"fa-icon",3),t._uU(9," Confirmar"),t.qZA(),t.TgZ(10,"button",32),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return null==i.modalRef?null:i.modalRef.hide()}),t._uU(11,"Cancelar"),t.qZA(),t.qZA()}2&e&&(t.xp6(8),t.Q6J("icon",t.DdM(1,l)))}const Y=function(){return["fas","hand-peace"]};function H(e,c){if(1&e&&(t.TgZ(0,"div",33),t._UZ(1,"fa-icon",19),t.TgZ(2,"h3",20),t._uU(3),t.qZA(),t.TgZ(4,"p",14),t._uU(5,"Esperando ser asignado"),t.qZA(),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("icon",t.DdM(2,Y)),t.xp6(2),t.hij("",null==n.myLift?null:n.myLift.name," libre")}}const Q=function(){return["fas","home"]},j=[{path:"assigned-truck",component:(()=>{class e{constructor(n,o,i,s,B){this.forkliftService=n,this.modalService=o,this.registryService=i,this.toast=s,this.authService=B,this.date=new Date,this.title="Montacarga",this._start=!1}ngOnInit(){this.getMyLift()}getMyLift(){this.forkliftService.getMyLift().subscribe(n=>{if(this.myLift=n,!n)return this.toast.warning("No tienes un montacarga asignado","Lo siento"),this.authService.logout();n.isFree||this.getUnloadTruck()})}getUnloadTruck(){this.forkliftService.getUnloadTruck().subscribe(n=>{n?(this.registry=Object.assign(Object.assign({},n),{bay:n.unloadBay,lift:n.unloadLift}),this.title=this.registry.lift.name):this.getLoadTruck()})}getLoadTruck(){this.forkliftService.getLoadTruck().subscribe(n=>{n&&(this.registry=Object.assign(Object.assign({},n),{bay:n.loadBay,lift:n.loadLift}),this.title=this.registry.lift.name)})}confirmModal(n,o=!0){this.modalRef=this.modalService.show(n,{class:"modal-sm modal-dialog-centered"})}unloadTruck(){var n;const o={unloadStartTime:(new Date).toJSON(),state:"DESCARGANDO"};null===(n=this.modalRef)||void 0===n||n.hide(),this.registryService.updateRegistry(this.registry._id,o).subscribe(i=>{this.registry=Object.assign(Object.assign({},this.registry),o)})}unloadEndTruck(){var n;const o={unloadEndTime:(new Date).toJSON(),state:"DESCARGADO"};null===(n=this.modalRef)||void 0===n||n.hide(),this.registryService.updateRegistry(this.registry._id,o).subscribe(i=>{this.registry=Object.assign(Object.assign({},this.registry),o),this.forkliftService.updateLift(this.myLift._id,{isFree:!0}).subscribe(s=>this.myLift=s)})}loadTruck(){var n;const o={loadStartTime:(new Date).toJSON(),state:"CARGANDO"};null===(n=this.modalRef)||void 0===n||n.hide(),this.registryService.updateRegistry(this.registry._id,o).subscribe(i=>{this.registry=Object.assign(Object.assign({},this.registry),o)})}loadEndTruck(){var n;const o={loadEndTime:(new Date).toJSON(),state:"CARGADO"};null===(n=this.modalRef)||void 0===n||n.hide(),this.registryService.updateRegistry(this.registry._id,o).subscribe(i=>{this.registry=Object.assign(Object.assign({},this.registry),o),this.forkliftService.updateLift(this.myLift._id,{isFree:!0}).subscribe(s=>this.myLift=s)})}start(){this._start=!0}clear(){this._start=!1}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(Z),t.Y36(T.tT),t.Y36(k),t.Y36(x._W),t.Y36(y.e))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-assigned-truck"]],decls:15,vars:4,consts:[["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],[3,"icon"],[4,"ngIf"],["unloadConfirm",""],["unloadEndConfirm",""],["loadConfirm",""],["loadEndConfirm",""],["class","text-center",4,"ngIf"],[1,"btn","btn-sm","btn-outline-dark","btn-rounded","float-end",3,"click"],[1,"text-end"],["class","pb-5",4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"text-muted"],[1,"pb-5"],["class","row",4,"ngIf"],[1,"row"],[1,"col-md-4","offset-md-4","text-center"],["size","4x",1,"text-primary",3,"icon"],[1,"mt-3"],["class","mt-4",4,"ngIf"],[1,"mt-4"],[1,"btn","btn-primary","btn-lg","w-100",3,"click"],[1,"text-danger"],[1,"text-info"],[1,"btn","btn-primary","btn-lg","w-100","mt-3",3,"click"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body","text-center"],["type","button",1,"btn","btn-primary","w-100","mb-2",3,"click"],["type","button",1,"btn","btn-outline-danger","w-100","mb-2",3,"click"],[1,"text-center"]],template:function(n,o){1&n&&(t.TgZ(0,"nav",0),t.TgZ(1,"ol",1),t.TgZ(2,"li",2),t._UZ(3,"fa-icon",3),t._uU(4," Inicio "),t.qZA(),t.qZA(),t.qZA(),t.YNc(5,I,9,8,"div",4),t.YNc(6,w,12,2,"ng-template",null,5,t.W1O),t.YNc(8,L,12,2,"ng-template",null,6,t.W1O),t.YNc(10,O,12,2,"ng-template",null,7,t.W1O),t.YNc(12,E,12,2,"ng-template",null,8,t.W1O),t.YNc(14,H,6,3,"div",9)),2&n&&(t.xp6(3),t.Q6J("icon",t.DdM(3,Q)),t.xp6(2),t.Q6J("ngIf",o.myLift),t.xp6(9),t.Q6J("ngIf",null==o.myLift?null:o.myLift.isFree))},directives:[_.BN,d.O5],pipes:[d.uU],styles:[""]}),e})()},{path:"",redirectTo:"assigned-truck",pathMatch:"full"}];let G=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[m.Bz.forChild(j)],m.Bz]}),e})();var a=r(801),z=r(6802);let $=(()=>{class e{constructor(n){n.addIcons(a.J9Y,a.LEp,a.a3n,a.$KU,a.d8e,a.iMS)}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(_.by))},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[d.ez,G,_.uH,T.zk.forRoot(),z.m]]}),e})()}}]);