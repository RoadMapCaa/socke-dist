"use strict";(self.webpackChunksocket_pwa=self.webpackChunksocket_pwa||[]).push([[702],{8702:(Q,Z,s)=>{s.r(Z),s.d(Z,{WarehouseModule:()=>G});var m=s(9808),_=s(9539),r=s(2382),t=s(5e3),h=s(62),A=s(2290),p=s(1134),f=s(2340),T=s(520);const{endpoint:q}=f.N,u=`${q}/control`;let v=(()=>{class o{constructor(e){this.http=e}getBahias(){return this.http.get(`${u}/bay/withregistry`)}getTrucks(){return this.http.get(`${u}/registry/arrivals`)}getLifts(){return this.http.get(`${u}/lift/list?isFree=true&isActive=true`)}updateLift(e,i){return this.http.put(`${u}/lift/${e}/update`,i)}setBayAndLift(e,i){return this.http.put(`${u}/registry/${e}/update`,i)}loadBahia(e,i){return this.http.put(`${u}/registry/${i}/update`,e)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(T.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var x=s(3722),g=s(9444);function B(o,n){if(1&o&&(t.TgZ(0,"div",22),t.TgZ(1,"small"),t._uU(2,"Hora inicio"),t.qZA(),t.TgZ(3,"h6",21),t._uU(4),t.ALo(5,"date"),t.qZA(),t.qZA()),2&o){const e=t.oxw(2).$implicit;t.xp6(4),t.Oqu(t.xi3(5,1,e.startTime,"HH:mm"))}}function C(o,n){if(1&o&&(t.TgZ(0,"div"),t.TgZ(1,"div",2),t.TgZ(2,"div",18),t.TgZ(3,"small"),t._uU(4,"Veh\xedculo"),t.qZA(),t.TgZ(5,"h4"),t._uU(6),t.qZA(),t.qZA(),t.TgZ(7,"div",18),t.TgZ(8,"small"),t._uU(9,"Montacarga"),t.qZA(),t.TgZ(10,"h5"),t._uU(11),t.qZA(),t.qZA(),t.qZA(),t.TgZ(12,"div",2),t.YNc(13,B,6,4,"div",19),t.TgZ(14,"div",20),t.TgZ(15,"small"),t._uU(16,"Estado"),t.qZA(),t.TgZ(17,"h6",21),t.TgZ(18,"small"),t._uU(19),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(6),t.Oqu(e.registry.truck.plaque),t.xp6(5),t.Oqu(e.registry.lift.name),t.xp6(2),t.Q6J("ngIf","CARGANDO"===e.registry.state||"DESCARGANDO"===e.registry.state),t.xp6(6),t.AsE("",e.registry.state,"","CARGANDO"===e.registry.state||"DESCARGANDO"===e.registry.state?"...":"","")}}function U(o,n){1&o&&(t.TgZ(0,"div",23),t.TgZ(1,"small"),t._uU(2,"Veh\xedculo"),t.qZA(),t.TgZ(3,"h4"),t._uU(4,"-------"),t.qZA(),t.TgZ(5,"small"),t._uU(6,"Estado"),t.qZA(),t.TgZ(7,"h6",0),t.TgZ(8,"small"),t._uU(9,"LIBRE"),t.qZA(),t.qZA(),t.qZA())}function b(o,n){if(1&o&&(t.TgZ(0,"div",12),t.TgZ(1,"div"),t.TgZ(2,"div",13),t.TgZ(3,"h5",14),t._uU(4),t.qZA(),t._UZ(5,"hr",15),t.YNc(6,C,20,5,"div",16),t.YNc(7,U,10,0,"div",17),t.qZA(),t.qZA(),t.qZA()),2&o){const e=n.$implicit;t.xp6(1),t.Gre("card mb-3 ",e.isFree?"bg-success-1":"bg-warning",""),t.xp6(3),t.Oqu(e.name),t.xp6(2),t.Q6J("ngIf",!e.isFree),t.xp6(1),t.Q6J("ngIf",e.isFree)}}function y(o,n){if(1&o&&(t.ynx(0),t.TgZ(1,"h6"),t._uU(2),t.qZA(),t.TgZ(3,"small"),t._uU(4),t.qZA(),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(2),t.Oqu(e.unloadBay.name),t.xp6(2),t.Oqu(e.unloadLift.name)}}function F(o,n){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",25),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,c=t.oxw(),d=t.MAs(33);return c.setUnloadBay(d,a)}),t._uU(2,"Asignar bah\xeda"),t.qZA(),t.BQk()}}function O(o,n){if(1&o&&(t.ynx(0),t.TgZ(1,"h6"),t._uU(2),t.qZA(),t.TgZ(3,"small"),t._uU(4),t.qZA(),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(2),t.Oqu(e.loadBay.name),t.xp6(2),t.Oqu(e.loadLift.name)}}function S(o,n){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",25),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,c=t.oxw(),d=t.MAs(35);return c.setLoadBay(d,a)}),t._uU(2,"Asignar bah\xeda"),t.qZA(),t.BQk()}}function k(o,n){if(1&o&&(t.TgZ(0,"tr"),t.TgZ(1,"th",24),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t._UZ(7,"br"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t.YNc(10,y,5,2,"ng-container",16),t.YNc(11,F,3,0,"ng-container",16),t.qZA(),t.TgZ(12,"td"),t.YNc(13,O,5,2,"ng-container",16),t.YNc(14,S,3,0,"ng-container",16),t.qZA(),t.qZA()),2&o){const e=n.$implicit,i=n.index;t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(e.arrivalTime),t.xp6(2),t.hij("",e.truck.plaque," "),t.xp6(2),t.hij(" ",e.truck.type.name," "),t.xp6(2),t.Q6J("ngIf",e.unloadBay),t.xp6(1),t.Q6J("ngIf",!e.unloadBay&&"CARGA"!==e.state&&"CARGANDO"!==e.state),t.xp6(2),t.Q6J("ngIf",e.loadBay),t.xp6(1),t.Q6J("ngIf",!e.loadBay&&"DESCARGA"!==e.state&&"DESCARGANDO"!==e.state)}}function N(o,n){if(1&o&&(t.TgZ(0,"option",42),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.s9C("value",e._id),t.xp6(1),t.Oqu(e.name)}}function w(o,n){if(1&o&&(t.TgZ(0,"option",42),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.s9C("value",e._id),t.xp6(1),t.Oqu(e.name)}}function L(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"div",26),t.TgZ(1,"h5",27),t._uU(2,"ASIGNAR BAHIA DE DESCARGA"),t.qZA(),t.TgZ(3,"button",28),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return null==a.modalRef?null:a.modalRef.hide()}),t.qZA(),t.qZA(),t.TgZ(4,"form",29),t.NdJ("submit",function(){return t.CHM(e),t.oxw().onSubmitUnload()}),t.TgZ(5,"div",30),t.TgZ(6,"div",31),t.TgZ(7,"div",18),t.TgZ(8,"small"),t._uU(9,"Cami\xf3n"),t.qZA(),t.TgZ(10,"h5"),t._uU(11),t.qZA(),t.qZA(),t.TgZ(12,"div",18),t.TgZ(13,"small"),t._uU(14,"Tipo"),t.qZA(),t.TgZ(15,"h6",0),t._uU(16),t.qZA(),t.qZA(),t.qZA(),t.TgZ(17,"div",32),t.TgZ(18,"label",33),t._uU(19,"Seleccione Bah\xeda"),t.qZA(),t.TgZ(20,"select",34),t.TgZ(21,"option",35),t._uU(22,"------------------"),t.qZA(),t.YNc(23,N,2,2,"option",36),t.qZA(),t.TgZ(24,"small",37),t._uU(25,"Bahias disponibles"),t.qZA(),t.qZA(),t.TgZ(26,"div",32),t.TgZ(27,"label",33),t._uU(28,"Seleccione Montacarga"),t.qZA(),t.TgZ(29,"select",38),t.TgZ(30,"option",35),t._uU(31,"------------------"),t.qZA(),t.YNc(32,w,2,2,"option",36),t.qZA(),t.TgZ(33,"small",37),t._uU(34,"Montacargas disponibles"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(35,"div",39),t.TgZ(36,"button",40),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return null==a.modalRef?null:a.modalRef.hide()}),t._uU(37,"Cancelar"),t.qZA(),t.TgZ(38,"button",41),t._uU(39,"Guardar"),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.xp6(4),t.Q6J("formGroup",e.unloadForm),t.xp6(7),t.Oqu(e.registry.truck.plaque),t.xp6(5),t.Oqu(e.registry.truck.type.name),t.xp6(7),t.Q6J("ngForOf",e.formBays),t.xp6(9),t.Q6J("ngForOf",e.lifts),t.xp6(6),t.Q6J("disabled",!e.unloadForm.valid)}}function R(o,n){if(1&o&&(t.TgZ(0,"option",42),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.s9C("value",e._id),t.xp6(1),t.Oqu(e.name)}}function J(o,n){if(1&o&&(t.TgZ(0,"option",42),t._uU(1),t.qZA()),2&o){const e=n.$implicit;t.s9C("value",e._id),t.xp6(1),t.Oqu(e.name)}}function D(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"div",26),t.TgZ(1,"h5",27),t._uU(2,"ASIGNAR BAHIA DE CARGA"),t.qZA(),t.TgZ(3,"button",28),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return null==a.modalRef?null:a.modalRef.hide()}),t.qZA(),t.qZA(),t.TgZ(4,"form",29),t.NdJ("submit",function(){return t.CHM(e),t.oxw().onSubmitLoad()}),t.TgZ(5,"div",30),t.TgZ(6,"div",31),t.TgZ(7,"div",18),t.TgZ(8,"small"),t._uU(9,"Cami\xf3n"),t.qZA(),t.TgZ(10,"h5"),t._uU(11),t.qZA(),t.qZA(),t.TgZ(12,"div",18),t.TgZ(13,"small"),t._uU(14,"Tipo"),t.qZA(),t.TgZ(15,"h6",0),t._uU(16),t.qZA(),t.qZA(),t.qZA(),t.TgZ(17,"div",32),t.TgZ(18,"label",33),t._uU(19,"Seleccione Bah\xeda"),t.qZA(),t.TgZ(20,"select",43),t.TgZ(21,"option",35),t._uU(22,"------------------"),t.qZA(),t.YNc(23,R,2,2,"option",36),t.qZA(),t.TgZ(24,"small",37),t._uU(25,"Bahias disponibles"),t.qZA(),t.qZA(),t.TgZ(26,"div",32),t.TgZ(27,"label",33),t._uU(28,"Seleccione Montacarga"),t.qZA(),t.TgZ(29,"select",44),t.TgZ(30,"option",35),t._uU(31,"------------------"),t.qZA(),t.YNc(32,J,2,2,"option",36),t.qZA(),t.TgZ(33,"small",37),t._uU(34,"Montacargas disponibles"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(35,"div",39),t.TgZ(36,"button",40),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return null==a.modalRef?null:a.modalRef.hide()}),t._uU(37,"Cancelar"),t.qZA(),t.TgZ(38,"button",41),t._uU(39,"Guardar"),t.qZA(),t.qZA(),t.qZA()}if(2&o){const e=t.oxw();t.xp6(4),t.Q6J("formGroup",e.loadForm),t.xp6(7),t.Oqu(e.registry.truck.plaque),t.xp6(5),t.Oqu(e.registry.truck.type.name),t.xp6(7),t.Q6J("ngForOf",e.formBays),t.xp6(9),t.Q6J("ngForOf",e.lifts),t.xp6(6),t.Q6J("disabled",!e.loadForm.valid)}}const E=function(){return["fas","sync-alt"]},M=[{path:"bahias",component:(()=>{class o{constructor(e,i,a,c,d,I){this.fb=e,this.common=i,this.toast=a,this.modalService=c,this.warehouseService=d,this.wsService=I,this.date=Date.now(),this.bahias=[],this.trucks=[],this.lifts=[],this.formBays=[],this.unloadForm=this.fb.group({unloadBay:["",r.kI.required],unloadLift:["",r.kI.required]}),this.loadForm=this.fb.group({loadBay:["",r.kI.required],loadLift:["",r.kI.required]})}ngOnInit(){this.loadArrivalTrucks(),this.loadBays(),this.loadLifts()}changeWare(){console.log("Ware please"),this.common.wareChanged.emit({changed:!0}),this.wsService.emit("load-bays-tv")}onSubmitUnload(){const e=this.unloadForm.getRawValue();e.state="DESCARGA",this.warehouseService.setBayAndLift(this.registry._id,e).subscribe(i=>{var a;this.loadArrivalTrucks(),null===(a=this.modalRef)||void 0===a||a.hide(),this.toast.success("Se asign\xf3 la bah\xeda y el montacarga correctamente!!!"),this.updateLift(e.unloadLift,{isFree:!1}),this.loadBays(),this.common.wareChanged.emit(!0),this.wsService.emit("load-bays-tv"),this.wsService.emit("arrivals")})}onSubmitLoad(){const e=this.loadForm.getRawValue();e.state="CARGA",this.warehouseService.setBayAndLift(this.registry._id,e).subscribe(i=>{var a;this.loadArrivalTrucks(),this.updateLift(e.loadLift,{isFree:!1}),this.loadBays(),this.toast.success("Se asign\xf3 la bah\xeda y el montacarga correctamente!!!"),null===(a=this.modalRef)||void 0===a||a.hide(),this.common.wareChanged.emit(!0),this.wsService.emit("load-bays-tv"),this.wsService.emit("arrivals")})}setUnloadBay(e,i){this.registry=i,this.modalRef=this.modalService.show(e,{class:"modal-dialog-centered"})}setLoadBay(e,i){this.registry=i,this.modalRef=this.modalService.show(e,{class:"modal-dialog-centered"})}loadBays(){this.warehouseService.getBahias().subscribe(e=>{this.bahias=e.map(i=>{var a;return i.isFree=!i.unload,i.unload&&"DESCARGADO"===i.unload.state&&(i.isFree=!0),i.isFree&&(i.isFree=!i.load,i.load&&"CARGADO"===i.load.state&&(i.isFree=!0)),i.isFree||(i.unload?(i.registry=i.unload,i.startTime=i.unload.unloadStartTime):(i.registry=i.load,i.startTime=i.load.loadStartTime),i.registry.lift=(null===(a=i.unload)||void 0===a?void 0:a.unloadLift)?i.unload.unloadLift:i.load.loadLift),i}),this.formBays=e.filter(i=>i.isFree)})}loadLifts(){this.warehouseService.getLifts().subscribe(e=>this.lifts=e)}updateLift(e,i){this.warehouseService.updateLift(e,i).subscribe(a=>this.loadLifts())}loadArrivalTrucks(){this.warehouseService.getTrucks().subscribe(e=>this.trucks=e)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(r.qu),t.Y36(h.v),t.Y36(A._W),t.Y36(p.tT),t.Y36(v),t.Y36(x.i))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-bahias"]],decls:36,vars:8,consts:[[1,"text-muted"],[1,"text-end"],[1,"row"],["class","col-md-4",4,"ngFor","ngForOf"],[1,"btn","btn-sm","btn-outline-dark","btn-rounded",3,"click"],[3,"icon"],[1,"table-responsive"],[1,"table"],["scope","col"],[4,"ngFor","ngForOf"],["assignUnloadTemplate",""],["assignLoadTemplate",""],[1,"col-md-4"],[1,"card-body"],[1,"card-title"],[1,"m-0"],[4,"ngIf"],["class","text-center text-success",4,"ngIf"],[1,"col"],["class","col-md-4 text-center",4,"ngIf"],[1,"col-md-8","text-center"],[1,"text-danger"],[1,"col-md-4","text-center"],[1,"text-center","text-success"],["scope","row"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[3,"formGroup","submit"],[1,"modal-body"],[1,"row","mb-4"],[1,"mb-3"],[1,"form-label"],["formControlName","unloadBay",1,"form-select"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"form-text"],["formControlName","unloadLift",1,"form-select"],[1,"modal-footer"],["type","button",1,"btn","btn-danger","btn-mob","mb-2",3,"click"],["type","submit",1,"btn","btn-primary","btn-mob","mb-2",3,"disabled"],[3,"value"],["formControlName","loadBay",1,"form-select"],["formControlName","loadLift",1,"form-select"]],template:function(e,i){1&e&&(t.TgZ(0,"h3"),t._uU(1,"Asistencia| "),t.TgZ(2,"small",0),t._uU(3,"Control de bah\xedas"),t.qZA(),t.qZA(),t._UZ(4,"hr"),t.TgZ(5,"p",1),t._uU(6),t.ALo(7,"date"),t.qZA(),t.TgZ(8,"div",2),t.YNc(9,b,8,6,"div",3),t.qZA(),t.TgZ(10,"div",1),t.TgZ(11,"button",4),t.NdJ("click",function(){return i.ngOnInit()}),t._UZ(12,"fa-icon",5),t.qZA(),t.qZA(),t.TgZ(13,"h5"),t._uU(14),t.qZA(),t.TgZ(15,"div",6),t.TgZ(16,"table",7),t.TgZ(17,"thead"),t.TgZ(18,"tr"),t.TgZ(19,"th",8),t._uU(20,"#"),t.qZA(),t.TgZ(21,"th",8),t.TgZ(22,"small"),t._uU(23,"Hora llegada"),t.qZA(),t.qZA(),t.TgZ(24,"th",8),t._uU(25,"Veh\xedculo"),t.qZA(),t.TgZ(26,"th",8),t._uU(27,"Descarga"),t.qZA(),t.TgZ(28,"th",8),t._uU(29,"Carga"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(30,"tbody"),t.YNc(31,k,15,8,"tr",9),t.qZA(),t.qZA(),t.qZA(),t.YNc(32,L,40,6,"ng-template",null,10,t.W1O),t.YNc(34,D,40,6,"ng-template",null,11,t.W1O)),2&e&&(t.xp6(6),t.Oqu(t.lcZ(7,5,i.date)),t.xp6(3),t.Q6J("ngForOf",i.bahias),t.xp6(3),t.Q6J("icon",t.DdM(7,E)),t.xp6(2),t.hij("",i.trucks.length," Camiones en cola"),t.xp6(17),t.Q6J("ngForOf",i.trucks))},directives:[m.sg,m.O5,g.BN,r._Y,r.JL,r.sg,r.EJ,r.JJ,r.u,r.YN,r.Kr],pipes:[m.uU],styles:[".bg-success-1[_ngcontent-%COMP%]{background-color:#a0ffa0}"]}),o})()},{path:"",redirectTo:"bahias",pathMatch:"full"}];let Y=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[_.Bz.forChild(M)],_.Bz]}),o})();var l=s(801);let G=(()=>{class o{constructor(e){e.addIcons(l.r6l,l.J9Y,l.Xcf,l.zVD,l.d8e,l.LEp,l.LM3)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(g.by))},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[m.ez,Y,g.uH,p.zk.forRoot(),r.UX]]}),o})()}}]);