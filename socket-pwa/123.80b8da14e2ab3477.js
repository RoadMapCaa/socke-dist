"use strict";(self.webpackChunksocket_pwa=self.webpackChunksocket_pwa||[]).push([[123],{8123:(X,m,r)=>{r.r(m),r.d(m,{ForkliftModule:()=>K});var u=r(9808),g=r(9539),t=r(5e3),f=r(2340),p=r(520);const{endpoint:h}=f.N,d=`${h}/control`;let Z=(()=>{class e{constructor(i){this.http=i}getUnloadTruck(){return this.http.get(`${d}/registry/unload-truck`)}getLoadTruck(){return this.http.get(`${d}/registry/load-truck`)}getMyLift(){return this.http.get(`${d}/lift-operator/mylift`)}updateLift(i,s){return this.http.put(`${d}/lift/${i}/update`,s)}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(p.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var T=r(1134);const{endpoint:A}=f.N,v=`${A}/control`;let x=(()=>{class e{constructor(i){this.http=i}updateRegistry(i,s){return this.http.put(`${v}/registry/${i}/update`,s)}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(p.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var k=r(2290),C=r(7423),_=r(9444);const y=function(e){return{blink:e}};function b(e,o){if(1&e&&(t.TgZ(0,"div",1),t.TgZ(1,"div",2),t._uU(2," Transcurrido "),t.qZA(),t.TgZ(3,"div",3),t.TgZ(4,"span"),t._uU(5),t.qZA(),t.TgZ(6,"span"),t._uU(7),t.qZA(),t.TgZ(8,"span"),t._uU(9),t.qZA(),t.qZA(),t.qZA()),2&e){const i=t.oxw();t.Q6J("ngClass",t.VKq(4,y,!i.running)),t.xp6(5),t.hij("",i.hours,":"),t.xp6(2),t.hij("",i.minutes,":"),t.xp6(2),t.Oqu(i.seconds)}}let q=(()=>{class e{constructor(){this.hours="00",this.minutes="00",this.seconds="00",this.milliseconds="00",this.laps=[],this.running=!1,this.startText="Empezar"}ngOnChanges(i){console.log(i.start),i.start.currentValue?this.startTimer():this.clearTimer()}startTimer(){if(this.running=!this.running,this.running){this.startText="Stop";const i=new Date(this.startTime).valueOf()-(this.counter||0);this.timerRef=setInterval(()=>{this.counter=Date.now()-i,this.hours=Math.floor(this.counter%864e5/36e5),this.minutes=Math.floor(this.counter%36e5/6e4),this.seconds=Math.floor(this.counter%6e4/1e3),this.minutes=Number(this.minutes)<10?"0"+this.minutes:""+this.minutes,this.milliseconds=Number(this.milliseconds)<10?"0"+this.milliseconds:""+this.milliseconds,this.seconds=Number(this.seconds)<10?"0"+this.seconds:""+this.seconds})}else this.startText="Resume",clearInterval(this.timerRef)}lapTimeSplit(){this.laps.push(this.minutes+":"+this.seconds+":"+this.milliseconds)}clearTimer(){this.running=!1,this.startText="Empezar",this.counter=void 0,this.milliseconds="00",this.seconds="00",this.minutes="00",this.hours="00",this.laps=[],clearInterval(this.timerRef)}ngOnDestroy(){clearInterval(this.timerRef)}}return e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-timer"]],inputs:{start:"start",showTimerControls:"showTimerControls",startTime:"startTime"},features:[t.TTD],decls:2,vars:1,consts:[["class","",3,"ngClass",4,"ngIf"],[1,"",3,"ngClass"],[1,"h6"],[1,"h4","text-secondary","fw-bold"]],template:function(i,s){1&i&&(t.TgZ(0,"section"),t.YNc(1,b,10,6,"div",0),t.qZA()),2&i&&(t.xp6(1),t.Q6J("ngIf",s.startTime))},directives:[u.O5,u.mk],styles:[""]}),e})();function U(e,o){1&e&&(t.TgZ(0,"small",16),t._uU(1,"El cami\xf3n no ha ingresado a\xfan"),t.qZA())}function M(e,o){if(1&e&&(t.TgZ(0,"small",16),t._uU(1),t.qZA()),2&e){const i=t.oxw(3);t.xp6(1),t.hij("","DESCARGA"===i.registry.state?"Descargar":"Cargar"," cami\xf3n")}}function R(e,o){if(1&e&&(t.TgZ(0,"h3"),t._uU(1),t.YNc(2,U,2,0,"small",15),t.YNc(3,M,2,1,"small",15),t.qZA()),2&e){const i=t.oxw(2);t.xp6(1),t.hij("",i.title,"| "),t.xp6(1),t.Q6J("ngIf",!(null!=i.registry&&i.registry.checkInTime)),t.xp6(1),t.Q6J("ngIf",null==i.registry?null:i.registry.checkInTime)}}const a=function(){return["fas","check"]};function N(e,o){if(1&e){const i=t.EpF();t.TgZ(0,"div",23),t.TgZ(1,"button",24),t.NdJ("click",function(){t.CHM(i);const n=t.oxw(4),c=t.MAs(7);return n.confirmModal(c)}),t._UZ(2,"fa-icon",3),t._uU(3," INICIAR DESCARGA "),t.qZA(),t.qZA()}2&e&&(t.xp6(2),t.Q6J("icon",t.DdM(1,a)))}function J(e,o){if(1&e){const i=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"small"),t._uU(2,"Hora inicio"),t.qZA(),t.TgZ(3,"h4",25),t._uU(4),t.ALo(5,"date"),t.qZA(),t._UZ(6,"app-timer",26),t.TgZ(7,"h3",27),t._uU(8,"DESCARGANDO..."),t.qZA(),t.TgZ(9,"button",28),t.NdJ("click",function(){t.CHM(i);const n=t.oxw(4),c=t.MAs(9);return n.confirmModal(c)}),t._UZ(10,"fa-icon",3),t._uU(11," FINALIZAR DESCARGA "),t.qZA(),t.qZA()}if(2&e){const i=t.oxw(4);t.xp6(4),t.Oqu(t.xi3(5,4,i.registry.unloadStartTime,"HH:mm")),t.xp6(2),t.Q6J("start",i._start)("startTime",i.registry.unloadStartTime),t.xp6(4),t.Q6J("icon",t.DdM(7,a))}}function S(e,o){if(1&e){const i=t.EpF();t.TgZ(0,"div",23),t.TgZ(1,"button",24),t.NdJ("click",function(){t.CHM(i);const n=t.oxw(4),c=t.MAs(11);return n.confirmModal(c)}),t._UZ(2,"fa-icon",3),t._uU(3," INICIAR CARGA "),t.qZA(),t.qZA()}2&e&&(t.xp6(2),t.Q6J("icon",t.DdM(1,a)))}function w(e,o){if(1&e){const i=t.EpF();t.TgZ(0,"div"),t.TgZ(1,"small"),t._uU(2,"Hora inicio"),t.qZA(),t.TgZ(3,"h4",25),t._uU(4),t.ALo(5,"date"),t.qZA(),t._UZ(6,"app-timer",26),t.TgZ(7,"h3",27),t._uU(8,"CARGANDO..."),t.qZA(),t.TgZ(9,"button",28),t.NdJ("click",function(){t.CHM(i);const n=t.oxw(4),c=t.MAs(13);return n.confirmModal(c)}),t._UZ(10,"fa-icon",3),t._uU(11," FINALIZAR CARGA "),t.qZA(),t.qZA()}if(2&e){const i=t.oxw(4);t.xp6(4),t.Oqu(t.xi3(5,4,i.registry.loadStartTime,"HH:mm")),t.xp6(2),t.Q6J("start",i._start)("startTime",i.registry.loadStartTime),t.xp6(4),t.Q6J("icon",t.DdM(7,a))}}const I=function(){return["fas","truck"]};function D(e,o){if(1&e&&(t.TgZ(0,"div",10),t.TgZ(1,"div",19),t._UZ(2,"fa-icon",20),t.TgZ(3,"p",21),t.TgZ(4,"small"),t._uU(5,"Cami\xf3n"),t.qZA(),t.qZA(),t.TgZ(6,"h4"),t._uU(7),t.TgZ(8,"small",16),t._uU(9),t.qZA(),t.qZA(),t.TgZ(10,"h5"),t._uU(11),t.qZA(),t.YNc(12,N,4,2,"div",22),t.YNc(13,J,12,8,"div",4),t.YNc(14,S,4,2,"div",22),t.YNc(15,w,12,8,"div",4),t.qZA(),t.qZA()),2&e){const i=t.oxw(3);t.xp6(2),t.Q6J("icon",t.DdM(8,I)),t.xp6(5),t.hij("",i.registry.truck.plaque," "),t.xp6(2),t.Oqu(i.registry.truck.type.name),t.xp6(2),t.Oqu(i.registry.bay.name),t.xp6(1),t.Q6J("ngIf","DESCARGA"===i.registry.state),t.xp6(1),t.Q6J("ngIf","DESCARGANDO"===i.registry.state),t.xp6(1),t.Q6J("ngIf","CARGA"===i.registry.state),t.xp6(1),t.Q6J("ngIf","CARGANDO"===i.registry.state)}}function F(e,o){if(1&e&&(t.TgZ(0,"div",17),t.YNc(1,D,16,9,"div",18),t.qZA()),2&e){const i=t.oxw(2);t.xp6(1),t.Q6J("ngIf",null==i.registry?null:i.registry.checkInTime)}}const O=function(){return["fas","sync-alt"]};function L(e,o){if(1&e){const i=t.EpF();t.TgZ(0,"div"),t.YNc(1,R,4,3,"h3",4),t._UZ(2,"hr"),t.TgZ(3,"div",10),t.TgZ(4,"div",11),t.TgZ(5,"button",12),t.NdJ("click",function(){return t.CHM(i),t.oxw().getMyLift()}),t._UZ(6,"fa-icon",3),t.qZA(),t.qZA(),t.TgZ(7,"div",11),t.TgZ(8,"p",13),t._uU(9),t.ALo(10,"date"),t.qZA(),t.qZA(),t.qZA(),t.YNc(11,F,2,1,"div",14),t.qZA()}if(2&e){const i=t.oxw();t.xp6(1),t.Q6J("ngIf",!i.myLift.isFree),t.xp6(5),t.Q6J("icon",t.DdM(7,O)),t.xp6(3),t.Oqu(t.xi3(10,4,i.date,"dd/MM/YY")),t.xp6(2),t.Q6J("ngIf",!i.myLift.isFree)}}function E(e,o){if(1&e){const i=t.EpF();t.TgZ(0,"div",29),t.TgZ(1,"h5",30),t._uU(2,"Iniciar descarga"),t.qZA(),t.TgZ(3,"button",31),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return null==n.modalRef?null:n.modalRef.hide()}),t.qZA(),t.qZA(),t.TgZ(4,"div",32),t.TgZ(5,"p"),t._uU(6,"Confirme el inicio de descarga del veh\xedculo"),t.qZA(),t.TgZ(7,"button",33),t.NdJ("click",function(){return t.CHM(i),t.oxw().unloadTruck()}),t._UZ(8,"fa-icon",3),t._uU(9," Confirmar"),t.qZA(),t.TgZ(10,"button",34),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return null==n.modalRef?null:n.modalRef.hide()}),t._uU(11,"Cancelar"),t.qZA(),t.qZA()}2&e&&(t.xp6(8),t.Q6J("icon",t.DdM(1,a)))}function Q(e,o){if(1&e){const i=t.EpF();t.TgZ(0,"div",29),t.TgZ(1,"h5",30),t._uU(2,"Finalizar descarga"),t.qZA(),t.TgZ(3,"button",31),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return null==n.modalRef?null:n.modalRef.hide()}),t.qZA(),t.qZA(),t.TgZ(4,"div",32),t.TgZ(5,"p"),t._uU(6,"Confirme que se ha finalizado la descarga del veh\xedculo"),t.qZA(),t.TgZ(7,"button",33),t.NdJ("click",function(){return t.CHM(i),t.oxw().unloadEndTruck()}),t._UZ(8,"fa-icon",3),t._uU(9," Confirmar"),t.qZA(),t.TgZ(10,"button",34),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return null==n.modalRef?null:n.modalRef.hide()}),t._uU(11,"Cancelar"),t.qZA(),t.qZA()}2&e&&(t.xp6(8),t.Q6J("icon",t.DdM(1,a)))}function Y(e,o){if(1&e){const i=t.EpF();t.TgZ(0,"div",29),t.TgZ(1,"h5",30),t._uU(2,"Iniciar carga"),t.qZA(),t.TgZ(3,"button",31),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return null==n.modalRef?null:n.modalRef.hide()}),t.qZA(),t.qZA(),t.TgZ(4,"div",32),t.TgZ(5,"p"),t._uU(6,"Confirme el inicio de carga del veh\xedculo"),t.qZA(),t.TgZ(7,"button",33),t.NdJ("click",function(){return t.CHM(i),t.oxw().loadTruck()}),t._UZ(8,"fa-icon",3),t._uU(9," Confirmar"),t.qZA(),t.TgZ(10,"button",34),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return null==n.modalRef?null:n.modalRef.hide()}),t._uU(11,"Cancelar"),t.qZA(),t.qZA()}2&e&&(t.xp6(8),t.Q6J("icon",t.DdM(1,a)))}function H(e,o){if(1&e){const i=t.EpF();t.TgZ(0,"div",29),t.TgZ(1,"h5",30),t._uU(2,"Finalizar carga"),t.qZA(),t.TgZ(3,"button",31),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return null==n.modalRef?null:n.modalRef.hide()}),t.qZA(),t.qZA(),t.TgZ(4,"div",32),t.TgZ(5,"p"),t._uU(6,"Confirme que se ha finalizado la carga del veh\xedculo"),t.qZA(),t.TgZ(7,"button",33),t.NdJ("click",function(){return t.CHM(i),t.oxw().loadEndTruck()}),t._UZ(8,"fa-icon",3),t._uU(9," Confirmar"),t.qZA(),t.TgZ(10,"button",34),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return null==n.modalRef?null:n.modalRef.hide()}),t._uU(11,"Cancelar"),t.qZA(),t.qZA()}2&e&&(t.xp6(8),t.Q6J("icon",t.DdM(1,a)))}const j=function(){return["fas","hand-peace"]};function G(e,o){if(1&e&&(t.TgZ(0,"div",35),t._UZ(1,"fa-icon",20),t.TgZ(2,"h3",21),t._uU(3),t.qZA(),t.TgZ(4,"p",16),t._uU(5,"Esperando ser asignado"),t.qZA(),t.qZA()),2&e){const i=t.oxw();t.xp6(1),t.Q6J("icon",t.DdM(2,j)),t.xp6(2),t.hij("",null==i.myLift?null:i.myLift.name," libre")}}const z=function(){return["fas","home"]},$=[{path:"assigned-truck",component:(()=>{class e{constructor(i,s,n,c,V){this.forkliftService=i,this.modalService=s,this.registryService=n,this.toast=c,this.authService=V,this.date=new Date,this.title="Montacarga",this._start=!1}ngOnInit(){this.getMyLift()}getMyLift(){this.forkliftService.getMyLift().subscribe(i=>{if(this.myLift=i,!i)return this.toast.warning("No tienes un montacarga asignado","Lo siento"),this.authService.logout();i.isActive&&!i.isFree&&this.getUnloadTruck()})}getUnloadTruck(){this.forkliftService.getUnloadTruck().subscribe(i=>{i?(console.log("gaaaaaaaaa",i),this._start=!0,this.registry=Object.assign(Object.assign({},i),{bay:i.unloadBay,lift:i.unloadLift}),this.title=this.registry.lift.name):this.getLoadTruck()})}getLoadTruck(){this.forkliftService.getLoadTruck().subscribe(i=>{i&&(this._start=!0,this.registry=Object.assign(Object.assign({},i),{bay:i.loadBay,lift:i.loadLift}),this.title=this.registry.lift.name)})}confirmModal(i,s=!0){this.modalRef=this.modalService.show(i,{class:"modal-sm modal-dialog-centered"})}unloadTruck(){var i;const s={unloadStartTime:(new Date).toJSON(),state:"DESCARGANDO"};this._start=!0,null===(i=this.modalRef)||void 0===i||i.hide(),this.registryService.updateRegistry(this.registry._id,s).subscribe(n=>{this.registry=Object.assign(Object.assign({},this.registry),s)})}unloadEndTruck(){var i;const s={unloadEndTime:(new Date).toJSON(),state:"DESCARGADO"};null===(i=this.modalRef)||void 0===i||i.hide(),this.registryService.updateRegistry(this.registry._id,s).subscribe(n=>{this.registry=Object.assign(Object.assign({},this.registry),s),this.forkliftService.updateLift(this.myLift._id,{isFree:!0}).subscribe(c=>{this._start=!1,this.myLift=c})})}loadTruck(){var i;const s={loadStartTime:(new Date).toJSON(),state:"CARGANDO"};null===(i=this.modalRef)||void 0===i||i.hide(),this._start=!0,this.registryService.updateRegistry(this.registry._id,s).subscribe(n=>{this.registry=Object.assign(Object.assign({},this.registry),s)})}loadEndTruck(){var i;const s={loadEndTime:(new Date).toJSON(),state:"CARGADO"};null===(i=this.modalRef)||void 0===i||i.hide(),this.registryService.updateRegistry(this.registry._id,s).subscribe(n=>{this.registry=Object.assign(Object.assign({},this.registry),s),this.forkliftService.updateLift(this.myLift._id,{isFree:!0}).subscribe(c=>{this._start=!1,this.myLift=c})})}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(Z),t.Y36(T.tT),t.Y36(x),t.Y36(k._W),t.Y36(C.e))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-assigned-truck"]],decls:15,vars:4,consts:[["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],[3,"icon"],[4,"ngIf"],["unloadConfirm",""],["unloadEndConfirm",""],["loadConfirm",""],["loadEndConfirm",""],["class","text-center",4,"ngIf"],[1,"row"],[1,"col"],[1,"btn","btn-sm","btn-outline-dark","btn-rounded",3,"click"],[1,"text-end"],["class","pb-5",4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"text-muted"],[1,"pb-5"],["class","row",4,"ngIf"],[1,"col-md-4","offset-md-4","text-center"],["size","4x",1,"text-primary",3,"icon"],[1,"mt-3"],["class","mt-4",4,"ngIf"],[1,"mt-4"],[1,"btn","btn-primary","btn-lg","w-100",3,"click"],[1,"text-danger"],[3,"start","startTime"],[1,"text-info"],[1,"btn","btn-primary","btn-lg","w-100","mt-3",3,"click"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body","text-center"],["type","button",1,"btn","btn-primary","w-100","mb-2",3,"click"],["type","button",1,"btn","btn-outline-danger","w-100","mb-2",3,"click"],[1,"text-center"]],template:function(i,s){1&i&&(t.TgZ(0,"nav",0),t.TgZ(1,"ol",1),t.TgZ(2,"li",2),t._UZ(3,"fa-icon",3),t._uU(4," Inicio "),t.qZA(),t.qZA(),t.qZA(),t.YNc(5,L,12,8,"div",4),t.YNc(6,E,12,2,"ng-template",null,5,t.W1O),t.YNc(8,Q,12,2,"ng-template",null,6,t.W1O),t.YNc(10,Y,12,2,"ng-template",null,7,t.W1O),t.YNc(12,H,12,2,"ng-template",null,8,t.W1O),t.YNc(14,G,6,3,"div",9)),2&i&&(t.xp6(3),t.Q6J("icon",t.DdM(3,z)),t.xp6(2),t.Q6J("ngIf",s.myLift),t.xp6(9),t.Q6J("ngIf",null==s.myLift?null:s.myLift.isFree))},directives:[_.BN,u.O5,q],pipes:[u.uU],styles:[""]}),e})()},{path:"",redirectTo:"assigned-truck",pathMatch:"full"}];let B=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[g.Bz.forChild($)],g.Bz]}),e})();var l=r(801),W=r(6802);let K=(()=>{class e{constructor(i){i.addIcons(l.J9Y,l.LEp,l.a3n,l.$KU,l.d8e,l.iMS)}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(_.by))},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[u.ez,B,_.uH,T.zk.forRoot(),W.m]]}),e})()}}]);