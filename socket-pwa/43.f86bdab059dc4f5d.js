"use strict";(self.webpackChunksocket_pwa=self.webpackChunksocket_pwa||[]).push([[43],{2043:($,f,s)=>{s.r(f),s.d(f,{AuthModule:()=>D});var m=s(9808),l=s(9539),t=s(5e3);let A=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-auth"]],decls:3,vars:0,consts:[[1,"vh-100"],[1,"container","py-5","h-100"]],template:function(e,n){1&e&&(t.TgZ(0,"section",0),t.TgZ(1,"div",1),t._UZ(2,"router-outlet"),t.qZA(),t.qZA())},directives:[l.lC],styles:[""]}),o})();var r=s(2382),h=s(7423),v=s(2290),d=s(9444);function T(o,i){if(1&o&&(t.TgZ(0,"button",16),t._uU(1,"Ingresar"),t.qZA()),2&o){const e=t.oxw();t.Q6J("disabled",e.form.invalid)}}const x=function(){return["fas","spinner"]};function C(o,i){1&o&&(t.TgZ(0,"button",17),t._UZ(1,"fa-icon",18),t._uU(2," Espere... "),t.qZA()),2&o&&(t.xp6(1),t.Q6J("icon",t.DdM(2,x))("spin",!0))}let y=(()=>{class o{constructor(e,n,a,u){this.fb=e,this.authService=n,this.toastrService=a,this.router=u,this.loading=!1,this.form=this.fb.group({username:["",r.kI.required],password:["",r.kI.required]})}ngOnInit(){}login(){this.loading=!0,!this.form.invalid&&this.authService.login(this.form.value).subscribe(e=>{this.loading=!1,e.user.isDriver?(this.saveRoute("driver"),this.router.navigateByUrl("/admin/driver")):e.user.isControl?(this.saveRoute("control"),this.router.navigateByUrl("/admin/control")):e.user.isAssistant?(this.saveRoute("warehouse"),this.router.navigateByUrl("/admin/warehouse")):e.user.isOperator&&(this.saveRoute("forklift"),this.router.navigateByUrl("/admin/forklift"))},e=>{this.loading=!1,this.toastrService.error(e.error.error,"Error")})}saveRoute(e){localStorage.setItem("route",e)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(r.qu),t.Y36(h.e),t.Y36(v._W),t.Y36(l.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-login"]],decls:24,vars:3,consts:[[1,"row","d-flex","justify-content-center","align-items-center","h-100"],[1,"col-12","col-md-8","col-lg-6","col-xl-5"],[1,"card",2,"border-radius","1rem"],[1,"card-body","p-md-5","text-center"],[1,"mb-md-5","mt-md-4","pb-3"],[1,"mb-3"],["src","../../../../assets/images/logo.png",1,"img-fluid","mb-2",2,"width","85px"],[1,"fw-bold","mb-2"],[3,"formGroup","submit"],["formControlName","username","type","text","placeholder","Usuario",1,"form-control"],["formControlName","password","type","password","placeholder","Contrase\xf1a","name","password","autocomplete","on",1,"form-control"],[1,"d-grid","gap-2"],["class","btn btn-outline-primary px-5","type","submit",3,"disabled",4,"ngIf"],["class","btn btn-outline-primary px-5","disabled","",4,"ngIf"],[1,"mb-0"],["routerLink","/auth/registration",1,"text-primary-50","fw-bold"],["type","submit",1,"btn","btn-outline-primary","px-5",3,"disabled"],["disabled","",1,"btn","btn-outline-primary","px-5"],[3,"icon","spin"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"div",4),t.TgZ(5,"div",5),t._UZ(6,"img",6),t.qZA(),t.TgZ(7,"h4",7),t._uU(8,"Sistema de colas"),t.qZA(),t.TgZ(9,"h5",5),t._uU(10,"Ingresar"),t.qZA(),t.TgZ(11,"form",8),t.NdJ("submit",function(){return n.login()}),t.TgZ(12,"div",5),t._UZ(13,"input",9),t.qZA(),t.TgZ(14,"div",5),t._UZ(15,"input",10),t.qZA(),t.TgZ(16,"div",11),t.YNc(17,T,2,1,"button",12),t.YNc(18,C,3,3,"button",13),t.qZA(),t.qZA(),t.qZA(),t.TgZ(19,"div"),t.TgZ(20,"p",14),t._uU(21," \xbfNo tienes cuenta todav\xeda? "),t.TgZ(22,"a",15),t._uU(23," Registrarme "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(11),t.Q6J("formGroup",n.form),t.xp6(6),t.Q6J("ngIf",!n.loading),t.xp6(1),t.Q6J("ngIf",n.loading))},directives:[r._Y,r.JL,r.sg,r.Fj,r.JJ,r.u,m.O5,d.BN,l.yS],styles:[""]}),o})();var p=s(1134);const Z=function(o){return["fas",o]};let b=(()=>{class o{constructor(e,n){this.bsModalRef=e,this.router=n}ngOnInit(){}navigate(){this.bsModalRef.hide(),this.router.navigateByUrl(this.link)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(p.UZ),t.Y36(l.F0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-modal-confirm"]],decls:11,vars:15,consts:[[1,"p-3"],[1,"text-center"],["size","2x",3,"icon"],[1,"mb-3"],[1,"d-grid","gap-2"],[1,"btn","btn-primary",3,"click"],[3,"icon"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h3"),t._uU(3),t.qZA(),t._UZ(4,"fa-icon",2),t.TgZ(5,"p",3),t._uU(6),t.qZA(),t.TgZ(7,"div",4),t.TgZ(8,"button",5),t.NdJ("click",function(){return n.navigate()}),t._UZ(9,"fa-icon",6),t._uU(10),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(2),t.Tol(n.color),t.xp6(1),t.Oqu(n.title),t.xp6(1),t.Gre("",n.colorIcon," mb-3"),t.Q6J("icon",t.VKq(11,Z,n.icon)),t.xp6(2),t.hij(" ",n.message," "),t.xp6(3),t.Q6J("icon",t.VKq(13,Z,n.iconBtn)),t.xp6(1),t.hij(" ",n.textBtn," "))},directives:[d.BN],encapsulation:2}),o})();var q=s(2340),U=s(9646),N=s(5963),I=s(3900),M=s(4004),R=s(520);const{endpoint:J}=q.N;let S=(()=>{class o{constructor(e,n){this.http=e,this.modalService=n}validate(){return e=>e.pristine?(0,U.of)(null):(0,N.H)(500).pipe((0,I.w)(()=>this.validateCedula(e.value)),(0,M.U)(n=>n?(this.openModalConfirm(n),{documentAlreadyExists:!0}):null))}validateCedula(e){return this.http.get(`${J}/auth/exist-user?document=${e}`)}openModalConfirm(e){this.bsModalRef=this.modalService.show(b,this.itIsRegistered(e)),this.bsModalRef.content.closeBtnName="Close"}itIsRegistered(e){const{firstName:n,lastName:a}=e;return{class:"modal-dialog-centered",initialState:{title:"\xa1Ya est\xe1 registrado!",color:"text-danger",colorIcon:"text-warning",message:`Sr. ${n} ${a}, usted ya esta registrado en el sistema de colas "WMS".Proceda a iniciar sesi\xf3n o registrarse desde el control.`,icon:"exclamation-triangle",iconBtn:"arrow-alt-circle-right",link:"/auth/login",textBtn:"Iniciar sesi\xf3n"}}}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(R.eN),t.LFG(p.tT))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function Y(o,i){if(1&o&&(t.TgZ(0,"span",21),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",e.documentErrorMsg," ")}}function B(o,i){1&o&&(t.TgZ(0,"span",21),t._uU(1," Nombres es requerido "),t.qZA())}function F(o,i){1&o&&(t.TgZ(0,"span",21),t._uU(1," Apellidos es requerido "),t.qZA())}const _=function(){return["fas","book"]};function w(o,i){if(1&o&&(t.TgZ(0,"button",22),t._UZ(1,"fa-icon",23),t._uU(2," Registrarme "),t.qZA()),2&o){const e=t.oxw();t.Q6J("disabled",e.form.invalid),t.xp6(1),t.Q6J("icon",t.DdM(2,_))}}const L=function(){return["fas","spinner"]};function Q(o,i){1&o&&(t.TgZ(0,"button",24),t._UZ(1,"fa-icon",23),t._uU(2," Espere... "),t.qZA()),2&o&&(t.xp6(1),t.Q6J("icon",t.DdM(1,L)))}const k=[{path:"",component:A,children:[{path:"login",component:y},{path:"registration",component:(()=>{class o{constructor(e,n,a,u,g){this.modalService=e,this.fb=n,this.cedulaValidator=a,this.authService=u,this.toastrService=g,this.loading=!1,this.form=this.fb.group({document:["",[r.kI.required,r.kI.minLength(8),r.kI.pattern("^[0-9]*$")],[this.cedulaValidator.validate()]],firstName:["",[r.kI.required]],lastName:["",[r.kI.required]],licence:[""],category:[""],isDriver:[!0]})}ngOnInit(){}openModalConfirm(e){this.bsModalRef=this.modalService.show(b,this.isRegistered(e)),this.bsModalRef.content.closeBtnName="Close"}isRegistered(e){const{firstName:n,lastName:a,username:u,password:g}=e;return{class:"modal-dialog-centered",keyboard:!1,ignoreBackdropClick:!0,initialState:{title:"\xa1\xa1\xa1Registro exitoso!!!",color:"text-success",colorIcon:"text-success",message:`Bienvenido Sr. ${n} ${a}, sea registrado correctamente en el sistema de colas "WMS". \n          \n Usuario: ${u} \n          \n Contrase\xf1a: ${g}`,icon:"check",iconBtn:"arrow-alt-circle-right",link:"/auth/login",textBtn:"Adelante"}}}get documentErrorMsg(){var e;const n=null===(e=this.form.get("document"))||void 0===e?void 0:e.errors;return(null==n?void 0:n.required)?"Dni es requerido":n.documentAlreadyExists?"Ya existe usuario con ese documento":(null==n?void 0:n.minlength)?"DNI debe tener al menos 8 caracteres":(null==n?void 0:n.pattern)?"Solo se acepta n\xfameros":""}invalidField(e){var n,a;return(null===(n=this.form.get(e))||void 0===n?void 0:n.invalid)&&(null===(a=this.form.get(e))||void 0===a?void 0:a.touched)}register(){this.form.invalid||(this.loading=!0,this.authService.register(this.form.value).subscribe(e=>{this.openModalConfirm(e),this.loading=!1},e=>{this.loading=!1,this.toastrService.error(e.error.error,"Error")}))}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(p.tT),t.Y36(r.qu),t.Y36(S),t.Y36(h.e),t.Y36(v._W))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-registration"]],decls:32,vars:6,consts:[[1,"row","d-flex","justify-content-center","align-items-center","h-100"],[1,"col-12","col-md-8","col-lg-6","col-xl-5"],[1,"card",2,"border-radius","1rem"],[1,"card-body","p-md-5"],[1,"mb-md-5","mt-md-2","pb-2"],[1,"text-center"],[1,"mb-3"],["src","../../../../assets/images/logo.png",1,"img-fluid","mb-2",2,"width","85px"],[1,"fw-bold","mb-3"],[3,"formGroup","submit"],["formControlName","document","type","text","placeholder","Ced\xfala/DNI",1,"form-control"],["class","form-text text-danger",4,"ngIf"],["formControlName","firstName","type","text","placeholder","Nombres",1,"form-control"],["formControlName","lastName","type","text","placeholder","Apellidos",1,"form-control"],["formControlName","licence","type","text","placeholder","Licencia de conducir",1,"form-control"],["formControlName","category","type","text","placeholder","Categoria",1,"form-control"],[1,"d-grid","gap-2"],["class","btn btn-outline-primary  px-5","type","submit",3,"disabled",4,"ngIf"],["class","btn btn-outline-primary  px-5","disabled","",4,"ngIf"],[1,"mb-0"],["routerLink","/auth/login",1,"text-primary-50","fw-bold"],[1,"form-text","text-danger"],["type","submit",1,"btn","btn-outline-primary","px-5",3,"disabled"],[3,"icon"],["disabled","",1,"btn","btn-outline-primary","px-5"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"div",4),t.TgZ(5,"div",5),t.TgZ(6,"div",6),t._UZ(7,"img",7),t.qZA(),t.TgZ(8,"h4",8),t._uU(9,"Me registrar\xe9"),t.qZA(),t.qZA(),t.TgZ(10,"form",9),t.NdJ("submit",function(){return n.register()}),t.TgZ(11,"div",6),t._UZ(12,"input",10),t.YNc(13,Y,2,1,"span",11),t.qZA(),t.TgZ(14,"div",6),t._UZ(15,"input",12),t.YNc(16,B,2,0,"span",11),t.qZA(),t.TgZ(17,"div",6),t._UZ(18,"input",13),t.YNc(19,F,2,0,"span",11),t.qZA(),t.TgZ(20,"div",6),t._UZ(21,"input",14),t.qZA(),t.TgZ(22,"div",6),t._UZ(23,"input",15),t.qZA(),t.TgZ(24,"div",16),t.YNc(25,w,3,3,"button",17),t.YNc(26,Q,3,2,"button",18),t.qZA(),t.qZA(),t.qZA(),t.TgZ(27,"div",5),t.TgZ(28,"p",19),t._uU(29," \xbfYa tienes cuenta? "),t.TgZ(30,"a",20),t._uU(31," Ingresar "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(10),t.Q6J("formGroup",n.form),t.xp6(3),t.Q6J("ngIf",n.invalidField("document")),t.xp6(3),t.Q6J("ngIf",n.invalidField("firstName")),t.xp6(3),t.Q6J("ngIf",n.invalidField("lastName")),t.xp6(6),t.Q6J("ngIf",!n.loading),t.xp6(1),t.Q6J("ngIf",n.loading))},directives:[r._Y,r.JL,r.sg,r.Fj,r.JJ,r.u,m.O5,d.BN,l.yS],styles:[""]}),o})()},{path:"",redirectTo:"login",pathMatch:"full"}]}];let E=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[l.Bz.forChild(k)],l.Bz]}),o})();var c=s(801),j=s(3596);let D=(()=>{class o{constructor(e){e.addIcons(c.FL8,c.eHv,c.JYN,c.LEp,c.LM3)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(d.by))},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[m.ez,E,d.uH,j.N,r.UX]]}),o})()}}]);