"use strict";(self.webpackChunksocket_pwa=self.webpackChunksocket_pwa||[]).push([[520],{7520:(tt,Z,s)=>{s.r(Z),s.d(Z,{SortingModule:()=>P});var c=s(9808),m=s(9539),T=s(5898),v=s(2340),t=s(5e3),_=s(3502);let C=(()=>{class o extends T.sk{constructor(){super({url:v.N.wsUrl,options:{}}),this.ioSocket.auth={"x-token":localStorage.getItem("access_token")}}}return o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-sorting"]],features:[t.qOj],decls:3,vars:0,consts:[[1,"container","mt-4"]],template:function(e,i){1&e&&(t._UZ(0,"app-navbar"),t.TgZ(1,"div",0),t._UZ(2,"router-outlet"),t.qZA())},directives:[_.S,m.lC],encapsulation:2}),o})();var n=s(2382),q=s(520);const{endpoint:g}=v.N,p=`${g}/sorting`,A=`${g}/sorting/type-review`,x=`${g}/sorting/type-container`,S=`${g}/sorting/sub-category`,J=`${g}/sorting/sub-category`;let y=(()=>{class o{constructor(e){this.http=e}list(){return this.http.get(p)}get(e){return this.http.get(`${p}/detail/${e}`)}insert(e){return this.http.post(p,e)}update(e,i){return this.http.put(`${p}/${e}`,i)}listTypeReviews(){return this.http.get(A)}listTypeContainers(){return this.http.get(x)}listCategories(){return this.http.get(S)}listMbfu(e){return this.http.get(`${J}/${e}`)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(q.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var b=s(7556),d=s(9444);function U(o,r){if(1&o&&(t.TgZ(0,"option",14),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(null==e?null:e.name)}}function N(o,r){if(1&o&&(t.TgZ(0,"option",14),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(null==e?null:e.name)}}const w=function(){return["fas","hourglass-start"]};function k(o,r){if(1&o&&(t.TgZ(0,"button",15),t._UZ(1,"fa-icon",16),t._uU(2," Iniciar "),t.qZA()),2&o){const e=t.oxw();t.Q6J("disabled",!e.form.valid),t.xp6(1),t.Q6J("icon",t.DdM(2,w))}}const F=function(){return["fas","spinner"]};function I(o,r){1&o&&(t.TgZ(0,"button",17),t._UZ(1,"fa-icon",18),t._uU(2," Espere... "),t.qZA()),2&o&&(t.xp6(1),t.Q6J("icon",t.DdM(2,F))("spin",!0))}let Q=(()=>{class o{constructor(e,i,a,l,u){this.fb=e,this.sortingService=i,this.authService=a,this.router=l,this.location=u,this.loading=!1,this.sending=!1,this.user=this.authService.user,this.typeReviews=[],this.typeContainers=[],this.form=this.fb.group({deliveryUnit:["",[n.kI.required]],startTime:[""],sorter:[this.user.uid,[n.kI.required]],reviewType:["",[n.kI.required]],containerType:["",[n.kI.required]],classifiedBoxes:["",[n.kI.required]]}),history.pushState(null,"",window.location.href),this.location.onPopState(()=>{history.pushState(null,"",window.location.href)})}ngOnInit(){this.listTypeReviews(),this.listTypeContainers()}listTypeReviews(){this.loading=!0,this.sortingService.listTypeReviews().subscribe(e=>{this.typeReviews=e,this.loading=!1})}listTypeContainers(){this.loading=!0,this.sortingService.listTypeContainers().subscribe(e=>{this.typeContainers=e,this.loading=!1})}sendData(){this.form.invalid||(this.form.patchValue({startTime:new Date}),this.sortingService.insert(this.form.value).subscribe(e=>{this.router.navigate(["/sorting/form",e._id])}))}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(n.qu),t.Y36(y),t.Y36(b.e),t.Y36(m.F0),t.Y36(c.S$))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-sorting"]],decls:28,vars:5,consts:[[1,"container"],[1,"mb-4",3,"formGroup","submit"],[1,"row"],[1,"col-md-6"],[1,"form-group","mb-3"],[1,"form-label"],["type","text","formControlName","deliveryUnit",1,"form-control"],["formControlName","reviewType",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],["formControlName","containerType",1,"form-select"],["type","number","formControlName","classifiedBoxes",1,"form-control"],[1,"text-end"],["type","submit","class","btn btn-primary mt-3 btn-mob",3,"disabled",4,"ngIf"],["type","button","class","btn btn-primary mt-3","disabled","",4,"ngIf"],[3,"value"],["type","submit",1,"btn","btn-primary","mt-3","btn-mob",3,"disabled"],[3,"icon"],["type","button","disabled","",1,"btn","btn-primary","mt-3"],[3,"icon","spin"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"form",1),t.NdJ("submit",function(){return i.sendData()}),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"div",4),t.TgZ(5,"label",5),t._uU(6,"BK-Placa"),t.qZA(),t._UZ(7,"input",6),t.qZA(),t.qZA(),t.TgZ(8,"div",3),t.TgZ(9,"div",4),t.TgZ(10,"label",5),t._uU(11,"Tipo Revisi\xf3n"),t.qZA(),t.TgZ(12,"select",7),t.YNc(13,U,2,2,"option",8),t.qZA(),t.qZA(),t.qZA(),t.TgZ(14,"div",3),t.TgZ(15,"div",4),t.TgZ(16,"label",5),t._uU(17,"Tipo Envase"),t.qZA(),t.TgZ(18,"select",9),t.YNc(19,N,2,2,"option",8),t.qZA(),t.qZA(),t.qZA(),t.TgZ(20,"div",3),t.TgZ(21,"div",4),t.TgZ(22,"label",5),t._uU(23,"Total Cajas"),t.qZA(),t._UZ(24,"input",10),t.qZA(),t.qZA(),t.qZA(),t.TgZ(25,"div",11),t.YNc(26,k,3,3,"button",12),t.YNc(27,I,3,3,"button",13),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(1),t.Q6J("formGroup",i.form),t.xp6(12),t.Q6J("ngForOf",i.typeReviews),t.xp6(6),t.Q6J("ngForOf",i.typeContainers),t.xp6(7),t.Q6J("ngIf",!i.loading),t.xp6(1),t.Q6J("ngIf",i.loading))},directives:[n._Y,n.JL,n.sg,n.Fj,n.JJ,n.u,n.EJ,c.sg,n.YN,n.Kr,n.wV,c.O5,d.BN],styles:[""]}),o})();var B=s(8620),O=s(7893);function Y(o,r){if(1&o&&(t.TgZ(0,"option",25),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(null==e?null:e.name)}}function $(o,r){if(1&o&&(t.TgZ(0,"option",25),t._uU(1),t.qZA()),2&o){const e=r.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(null==e?null:e.name)}}function R(o,r){if(1&o&&(t.TgZ(0,"div",26),t._UZ(1,"app-timer",27),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("start",e._start)("startTime",e.form.value.startTime)}}function M(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div",28),t.TgZ(1,"input",29),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw().toggleCheckBottle(l)}),t.qZA(),t.TgZ(2,"label",30),t._uU(3),t.qZA(),t.qZA()}if(2&o){const e=r.$implicit;t.xp6(1),t.Q6J("id",e._id)("checked",e.default),t.xp6(1),t.Q6J("for",e._id),t.xp6(1),t.Oqu(e.name)}}function D(o,r){if(1&o&&(t.TgZ(0,"div",31),t.ynx(1,32),t.TgZ(2,"div",33),t.TgZ(3,"label",5),t._uU(4),t.qZA(),t._UZ(5,"input",34),t.qZA(),t.BQk(),t.qZA()),2&o){const e=r.$implicit,i=r.index;t.xp6(1),t.Q6J("formGroupName",i),t.xp6(3),t.Oqu(e.value.subCategory.name)}}function E(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"div",28),t.TgZ(1,"input",29),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw().toggleCheckBox(l)}),t.qZA(),t.TgZ(2,"label",30),t._uU(3),t.qZA(),t.qZA()}if(2&o){const e=r.$implicit;t.xp6(1),t.Q6J("id",e._id)("checked",e.default),t.xp6(1),t.Q6J("for",e._id),t.xp6(1),t.Oqu(e.name)}}function G(o,r){if(1&o&&(t.TgZ(0,"div",35),t.ynx(1,32),t.TgZ(2,"div",33),t.TgZ(3,"label",5),t._uU(4),t.qZA(),t._UZ(5,"input",34),t.qZA(),t.BQk(),t.qZA()),2&o){const e=r.$implicit,i=r.index;t.xp6(1),t.Q6J("formGroupName",i),t.xp6(3),t.Oqu(e.value.subCategory.name)}}const L=function(){return["fas","hourglass-end"]};function j(o,r){if(1&o){const e=t.EpF();t.TgZ(0,"button",36),t.NdJ("click",function(){return t.CHM(e),t.oxw().sendData()}),t._UZ(1,"fa-icon",37),t._uU(2," Finalizar "),t.qZA()}if(2&o){const e=t.oxw();let i;t.Q6J("disabled",e.form.invalid||(null==(i=e.formd.get("bottle"))?null:i.invalid)||(null==(i=e.formd.get("box"))?null:i.invalid)),t.xp6(1),t.Q6J("icon",t.DdM(2,L))}}const z=function(){return["fas","spinner"]};function V(o,r){1&o&&(t.TgZ(0,"button",38),t._UZ(1,"fa-icon",39),t._uU(2," Espere... "),t.qZA()),2&o&&(t.xp6(1),t.Q6J("icon",t.DdM(2,z))("spin",!0))}const K=[{path:"",component:C,children:[{path:"form",component:Q},{path:"form/:id",component:(()=>{class o{constructor(e,i,a,l,u,h){this.fb=e,this.sortingService=i,this.authService=a,this.route=l,this.router=u,this.common=h,this.loading=!1,this.sending=!1,this._start=!0,this.id="",this.bottle={},this.box={},this.user=this.authService.user,this.now=(new Date).toISOString(),this.sortings=[],this.typeReviews=[],this.typeContainers=[],this.formd=this.fb.group({bottle:this.fb.array([]),box:this.fb.array([])}),this.form=this.fb.group({deliveryUnit:["",[n.kI.required]],startTime:[""],endTime:[""],reviewType:["",[n.kI.required]],containerType:["",[n.kI.required]],classifiedBoxes:["",[n.kI.required]],mbfu:[""]}),this.route.params.subscribe(({id:W})=>this.id=W)}ngOnInit(){this.get(this.id),this.listTypeReviews(),this.listTypeContainers(),this.listCategories()}get(e){this.sortingService.get(e).subscribe(i=>this.form.patchValue(i))}listTypeReviews(){this.loading=!0,this.sortingService.listTypeReviews().subscribe(e=>{this.typeReviews=e,this.loading=!1})}listTypeContainers(){this.loading=!0,this.sortingService.listTypeContainers().subscribe(e=>{this.typeContainers=e,this.loading=!1})}listCategories(){this.loading=!0,this.sortingService.listCategories().subscribe(e=>{this.bottle=e[0],this.box=e[1],this.loading=!1,e[0].sub.forEach(i=>{i.default&&this.formArrayBottle(i)}),e[1].sub.forEach(i=>{i.default&&this.formArrayBox(i)})})}formArrayBottle(e){this.formd.get("bottle").push(this.fb.group({type:[e._id,[n.kI.required]],subCategory:[e],quantity:["",[n.kI.required]]}))}formArrayBox(e){this.formd.get("box").push(this.fb.group({type:[e._id,[n.kI.required]],subCategory:[e],quantity:["",[n.kI.required]]}))}toggleCheckBottle(e){const i=this.formd.get("bottle");e.default?(e.default=!1,i.removeAt(i.value.findIndex(a=>a.type==e._id))):(e.default=!0,this.formArrayBottle(e))}toggleCheckBox(e){const i=this.formd.get("box");e.default?(e.default=!1,i.removeAt(i.value.findIndex(a=>a.type==e._id))):(e.default=!0,this.formArrayBox(e))}creatItem(){return this.fb.group({type:["",[n.kI.required]],quantity:["",[n.kI.required]]})}get formDataBottle(){return this.formd.get("bottle")}get formDataBox(){return this.formd.get("box")}sendData(){var e,i;this.sending=!0;const l=[...null===(e=this.formd.get("bottle"))||void 0===e?void 0:e.value,...null===(i=this.formd.get("box"))||void 0===i?void 0:i.value].map(({type:u,quantity:h})=>({type:u,quantity:h}));this.form.patchValue({mbfu:l}),this.form.patchValue({endTime:new Date}),this.sortingService.update(this.id,this.form.value).subscribe(u=>{this.common.showToast("Sorting creado correctamente!!!"),this.sending=!1,this._start=!1,this.router.navigate(["/sorting"])})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(n.qu),t.Y36(y),t.Y36(b.e),t.Y36(m.gz),t.Y36(m.F0),t.Y36(B.v_))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-sorting-category"]],decls:51,vars:13,consts:[[1,"container"],[1,"mb-4",3,"formGroup"],[1,"row"],[1,"col-md-6"],[1,"form-group","mb-3"],[1,"form-label"],["type","text","formControlName","deliveryUnit",1,"form-control"],["formControlName","reviewType",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],["formControlName","containerType",1,"form-select"],["type","number","formControlName","classifiedBoxes",1,"form-control"],["class","alert alert-primary text-center","role","alert",4,"ngIf"],[3,"formGroup"],[1,"col-md-6","mb-3"],[1,"card"],[1,"card-header","fw-bold","text-center"],[1,"card-body"],[1,"checks","d-flex","flex-wrap","gap-3","mb-3"],["class","form-check",4,"ngFor","ngForOf"],[1,"forms"],["class","col-md-6","formArrayName","bottle",4,"ngFor","ngForOf"],["class","col-md-6","formArrayName","box",4,"ngFor","ngForOf"],[1,"text-end","mb-3"],["type","submit","class","btn btn-primary mt-3",3,"disabled","click",4,"ngIf"],["type","button","class","btn btn-primary mt-3","disabled","",4,"ngIf"],[3,"value"],["role","alert",1,"alert","alert-primary","text-center"],[3,"start","startTime"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"id","checked","click"],[1,"form-check-label",3,"for"],["formArrayName","bottle",1,"col-md-6"],[3,"formGroupName"],[1,"mb-2"],["type","number","formControlName","quantity",1,"form-control"],["formArrayName","box",1,"col-md-6"],["type","submit",1,"btn","btn-primary","mt-3",3,"disabled","click"],[3,"icon"],["type","button","disabled","",1,"btn","btn-primary","mt-3"],[3,"icon","spin"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"form",1),t.TgZ(2,"div",2),t.TgZ(3,"div",3),t.TgZ(4,"div",4),t.TgZ(5,"label",5),t._uU(6,"BK-Placa"),t.qZA(),t._UZ(7,"input",6),t.qZA(),t.qZA(),t.TgZ(8,"div",3),t.TgZ(9,"div",4),t.TgZ(10,"label",5),t._uU(11,"Tipo Revisi\xf3n"),t.qZA(),t.TgZ(12,"select",7),t.YNc(13,Y,2,2,"option",8),t.qZA(),t.qZA(),t.qZA(),t.TgZ(14,"div",3),t.TgZ(15,"div",4),t.TgZ(16,"label",5),t._uU(17,"Tipo Envase"),t.qZA(),t.TgZ(18,"select",9),t.YNc(19,$,2,2,"option",8),t.qZA(),t.qZA(),t.qZA(),t.TgZ(20,"div",3),t.TgZ(21,"div",4),t.TgZ(22,"label",5),t._uU(23,"Total Cajas"),t.qZA(),t._UZ(24,"input",10),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(25,R,2,2,"div",11),t.TgZ(26,"form",12),t.TgZ(27,"div",2),t.TgZ(28,"div",13),t.TgZ(29,"div",14),t.TgZ(30,"div",15),t._uU(31),t.qZA(),t.TgZ(32,"div",16),t.TgZ(33,"div",17),t.YNc(34,M,4,4,"div",18),t.qZA(),t.TgZ(35,"div",19),t.TgZ(36,"form",2),t.YNc(37,D,6,2,"div",20),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(38,"div",3),t.TgZ(39,"div",14),t.TgZ(40,"div",15),t._uU(41),t.qZA(),t.TgZ(42,"div",16),t.TgZ(43,"div",17),t.YNc(44,E,4,4,"div",18),t.qZA(),t.TgZ(45,"div",19),t.TgZ(46,"form",2),t.YNc(47,G,6,2,"div",21),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(48,"div",22),t.YNc(49,j,3,3,"button",23),t.YNc(50,V,3,3,"button",24),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(1),t.Q6J("formGroup",i.form),t.xp6(12),t.Q6J("ngForOf",i.typeReviews),t.xp6(6),t.Q6J("ngForOf",i.typeContainers),t.xp6(6),t.Q6J("ngIf",i.form.value.startTime),t.xp6(1),t.Q6J("formGroup",i.formd),t.xp6(5),t.Oqu(null==i.bottle?null:i.bottle.name),t.xp6(3),t.Q6J("ngForOf",i.bottle.sub),t.xp6(3),t.Q6J("ngForOf",i.formDataBottle.controls),t.xp6(4),t.Oqu(null==i.box?null:i.box.name),t.xp6(3),t.Q6J("ngForOf",i.box.sub),t.xp6(3),t.Q6J("ngForOf",i.formDataBox.controls),t.xp6(2),t.Q6J("ngIf",!i.loading),t.xp6(1),t.Q6J("ngIf",i.loading))},directives:[n._Y,n.JL,n.sg,n.Fj,n.JJ,n.u,n.EJ,c.sg,n.YN,n.Kr,n.wV,c.O5,O.K,n.CE,n.x0,d.BN],styles:[""]}),o})()},{path:"",redirectTo:"form",pathMatch:"full"}]}];let H=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[m.Bz.forChild(K)],m.Bz]}),o})();var X=s(6802),f=s(801);let P=(()=>{class o{constructor(e){e.addIcons(f.LM3,f.yr5,f.B2l,f.AnG)}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(d.by))},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[c.ez,H,X.m,n.UX,d.uH]]}),o})()}}]);