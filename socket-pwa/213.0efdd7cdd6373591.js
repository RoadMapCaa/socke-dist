"use strict";(self.webpackChunksocket_pwa=self.webpackChunksocket_pwa||[]).push([[213],{213:(st,v,r)=>{r.r(v),r.d(v,{PickingModule:()=>ot});var u=r(9808),b=r(9539),C=r(5898),q=r(2340),t=r(5e3),U=r(3502);let y=(()=>{class n extends C.sk{constructor(){super({url:q.N.wsUrl,options:{}}),this.ioSocket.auth={"x-token":localStorage.getItem("access_token")}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-picking"]],features:[t.qOj],decls:3,vars:0,consts:[[1,"container-fluid","mt-4"]],template:function(e,i){1&e&&(t._UZ(0,"app-navbar"),t.TgZ(1,"div",0),t._UZ(2,"router-outlet"),t.qZA())},directives:[U.S,b.lC],encapsulation:2}),n})();var l=r(2382),Z=r(7579),w=r(520);const{endpoint:M}=q.N,d=`${M}/picking`;let p=(()=>{class n{constructor(e){this.http=e}list(e){return this.http.get(`${d}/list/${e}`)}statusUser(e){return this.http.get(`${d}/user/status/${e}`)}listUserPicking(e){return this.http.get(`${d}/user/list/${e}`)}saveListByUser(e){return this.http.post(`${d}/user`,e)}listDetail(e){return this.http.get(`${d}/${e}`)}update(e,i){return this.http.put(`${d}/${e}`,i)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(w.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var m=r(1134);function P(n,o){if(1&n&&(t.TgZ(0,"tr",8),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",12),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.qZA()),2&n){const e=o.$implicit,i=o.index;t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(null==e?null:e.name),t.xp6(2),t.Oqu(null==e?null:e.bottles)}}let O=(()=>{class n{constructor(e,i){this.pickingService=e,this.bsModalRef=i,this.picking="",this.bottles=[]}ngOnInit(){this.getDetail()}onConfirm(){this.bsModalRef.content.onClose.next(!0),this.bsModalRef.hide()}onCancel(){this.bsModalRef.content.onClose.next(!1),this.bsModalRef.hide()}getDetail(){this.pickingService.listDetail(this.picking._id).subscribe(e=>{this.bottles=e.detail.filter(i=>i.bottles>0)})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p),t.Y36(m.UZ))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-bottle-detail"]],inputs:{picking:"picking"},decls:30,vars:4,consts:[[1,"scrollModal"],[1,"modal-header"],[1,"modal-title","d-flex","justify-content-between","w-100"],[1,"modal-body"],[1,"table-responsive"],[1,"table","table-sm","table-striped","table-bordered"],[1,"fw-bold","text-center","table-primary",2,"font-size","14px"],["class","text-center align-middle",4,"ngFor","ngForOf"],[1,"text-center","align-middle"],["colspan","2"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary","btn-mobile",3,"click"],[1,"text-start"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h5",2),t.TgZ(3,"span"),t._uU(4,"Botellas"),t.qZA(),t.TgZ(5,"span"),t._uU(6),t.qZA(),t.TgZ(7,"span"),t._uU(8),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"div",3),t.TgZ(10,"div",4),t.TgZ(11,"table",5),t.TgZ(12,"thead"),t.TgZ(13,"tr",6),t.TgZ(14,"th"),t._uU(15,"#"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Nombre"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Botellas"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(20,"tbody"),t.YNc(21,P,7,3,"tr",7),t.TgZ(22,"tr",8),t.TgZ(23,"th",9),t._uU(24,"Total"),t.qZA(),t.TgZ(25,"th"),t._uU(26),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(27,"div",10),t.TgZ(28,"button",11),t.NdJ("click",function(){return i.onCancel()}),t._uU(29,"Cerrar"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(6),t.hij("Ruta: ",null==i.picking?null:i.picking.route,""),t.xp6(2),t.hij("Viaje: ",null==i.picking?null:i.picking.travel,""),t.xp6(13),t.Q6J("ngForOf",i.bottles),t.xp6(5),t.Oqu(null==i.picking?null:i.picking.bottles))},directives:[u.sg],styles:[".scrollModal[_ngcontent-%COMP%]{max-width:95vw;max-height:95vh}.table-responsive[_ngcontent-%COMP%]{max-height:75vh}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10}"]}),n})();function S(n,o){if(1&n&&(t.TgZ(0,"tr",8),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",12),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.qZA()),2&n){const e=o.$implicit,i=o.index;t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(null==e?null:e.name),t.xp6(2),t.Oqu(null==e?null:e.boxes)}}let D=(()=>{class n{constructor(e,i){this.pickingService=e,this.bsModalRef=i,this.picking="",this.boxes=[]}ngOnInit(){this.getDetail()}onConfirm(){this.bsModalRef.content.onClose.next(!0),this.bsModalRef.hide()}onCancel(){this.bsModalRef.content.onClose.next(!1),this.bsModalRef.hide()}getDetail(){this.pickingService.listDetail(this.picking._id).subscribe(e=>{this.boxes=e.detail.filter(i=>i.boxes>0)})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p),t.Y36(m.UZ))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-box-detail"]],inputs:{picking:"picking"},decls:30,vars:4,consts:[[1,"scrollModal"],[1,"modal-header"],[1,"modal-title","d-flex","justify-content-between","w-100"],[1,"modal-body"],[1,"table-responsive"],[1,"table","table-sm","table-striped","table-bordered"],[1,"fw-bold","text-center","table-primary",2,"font-size","14px"],["class","text-center align-middle",4,"ngFor","ngForOf"],[1,"text-center","align-middle"],["colspan","2"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary","btn-mobile",3,"click"],[1,"text-start"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h5",2),t.TgZ(3,"span"),t._uU(4,"Cajas"),t.qZA(),t.TgZ(5,"span"),t._uU(6),t.qZA(),t.TgZ(7,"span"),t._uU(8),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"div",3),t.TgZ(10,"div",4),t.TgZ(11,"table",5),t.TgZ(12,"thead"),t.TgZ(13,"tr",6),t.TgZ(14,"th"),t._uU(15,"#"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Nombre"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Cajas"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(20,"tbody"),t.YNc(21,S,7,3,"tr",7),t.TgZ(22,"tr",8),t.TgZ(23,"th",9),t._uU(24,"Total"),t.qZA(),t.TgZ(25,"th"),t._uU(26),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(27,"div",10),t.TgZ(28,"button",11),t.NdJ("click",function(){return i.onCancel()}),t._uU(29,"Cerrar"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(6),t.hij("Ruta: ",null==i.picking?null:i.picking.route,""),t.xp6(2),t.hij("Viaje: ",null==i.picking?null:i.picking.travel,""),t.xp6(13),t.Q6J("ngForOf",i.boxes),t.xp6(5),t.Oqu(null==i.picking?null:i.picking.boxes))},directives:[u.sg],styles:[".scrollModal[_ngcontent-%COMP%]{max-width:95vw;max-height:95vh}.table-responsive[_ngcontent-%COMP%]{max-height:75vh}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10}"]}),n})();function R(n,o){if(1&n&&(t.TgZ(0,"tr",8),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",12),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.qZA()),2&n){const e=o.$implicit,i=o.index;t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(null==e?null:e.name),t.xp6(2),t.Oqu(null==e?null:e.packages)}}let N=(()=>{class n{constructor(e,i){this.pickingService=e,this.bsModalRef=i,this.picking="",this.packages=[]}ngOnInit(){this.getDetail()}onConfirm(){this.bsModalRef.content.onClose.next(!0),this.bsModalRef.hide()}onCancel(){this.bsModalRef.content.onClose.next(!1),this.bsModalRef.hide()}getDetail(){this.pickingService.listDetail(this.picking._id).subscribe(e=>{this.packages=e.detail.filter(i=>i.packages>0)})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p),t.Y36(m.UZ))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-package-detail"]],inputs:{picking:"picking"},decls:30,vars:4,consts:[[1,"scrollModal"],[1,"modal-header"],[1,"modal-title","d-flex","justify-content-between","w-100"],[1,"modal-body"],[1,"table-responsive"],[1,"table","table-sm","table-striped","table-bordered"],[1,"fw-bold","text-center","table-primary",2,"font-size","14px"],["class","text-center align-middle",4,"ngFor","ngForOf"],[1,"text-center","align-middle"],["colspan","2"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary","btn-mobile",3,"click"],[1,"text-start"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h5",2),t.TgZ(3,"span"),t._uU(4,"Paquetes"),t.qZA(),t.TgZ(5,"span"),t._uU(6),t.qZA(),t.TgZ(7,"span"),t._uU(8),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"div",3),t.TgZ(10,"div",4),t.TgZ(11,"table",5),t.TgZ(12,"thead"),t.TgZ(13,"tr",6),t.TgZ(14,"th"),t._uU(15,"#"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Nombre"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Paquetes"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(20,"tbody"),t.YNc(21,R,7,3,"tr",7),t.TgZ(22,"tr",8),t.TgZ(23,"th",9),t._uU(24,"Total"),t.qZA(),t.TgZ(25,"th"),t._uU(26),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(27,"div",10),t.TgZ(28,"button",11),t.NdJ("click",function(){return i.onCancel()}),t._uU(29,"Cerrar"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(6),t.hij("Ruta: ",null==i.picking?null:i.picking.route,""),t.xp6(2),t.hij("Viaje: ",null==i.picking?null:i.picking.travel,""),t.xp6(13),t.Q6J("ngForOf",i.packages),t.xp6(5),t.Oqu(null==i.picking?null:i.picking.packages))},directives:[u.sg],styles:[".scrollModal[_ngcontent-%COMP%]{max-width:95vw;max-height:95vh}.table-responsive[_ngcontent-%COMP%]{max-height:75vh}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10}"]}),n})();var x=r(7556),A=r(8620),J=r(3722),f=r(9444);function I(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"a",16),t.NdJ("click",function(){return t.CHM(e),t.oxw().closeModal()}),t._uU(1,"Cerrar"),t.qZA()}}function F(n,o){if(1&n&&(t.TgZ(0,"h3",17),t._uU(1),t.ALo(2,"uppercase"),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij("",t.lcZ(2,1,e.message)," !!!")}}function Y(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"label",18),t.TgZ(1,"input",19),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.oxw().onCheck(c)}),t.qZA(),t._uU(2),t.qZA()}if(2&n){const e=o.$implicit;t.xp6(2),t.AsE(" ",e.route," - ",e.travel," ")}}function $(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",20),t.TgZ(1,"a",21),t.NdJ("click",function(){return t.CHM(e),t.oxw().confirmSave()}),t._uU(2,"Guardar"),t.qZA(),t.qZA()}}const j=function(){return["fas","sync-alt"]};let Q=(()=>{class n{constructor(e,i,s,c,a,g,h){this.pickingService=e,this.datePipe=i,this.fb=s,this.authService=c,this.common=a,this.bsModalRef=g,this.wsService=h,this.listLength=0,this.list=[],this.listChecked=[],this.title="Seleccionar Rutas",this.user=this.authService.user,this.message="",this.form=this.fb.group({date:[""]})}ngOnInit(){this.wsService.emit("picking"),this.formatedDate=this.datePipe.transform(Date.now(),"yyyy-MM-dd"),this.form.get("date").patchValue(this.formatedDate),this.suscription$=this.wsService.listen("to-picking").subscribe(()=>this.getList())}watch(){this.wsService.emit("picking"),this.list=[]}getList(){this.pickingService.listUserPicking(this.form.get("date").value).subscribe(e=>{this.list=e,this.message="",this.list.forEach(i=>{i.checked=!1})},e=>{this.message=e.error.message})}onCheck(e){e.checked=!e.checked}confirmSave(){const e=this;this.common.showConfirmSave("GUARDAR","Recuerda que una vez guardado no podr\xe1s modificar los datos. \xbfDeseas continuar?",function(s){s.isConfirmed&&(e.saveAllChecked(),e.common.showToast(`Se han guardado ${e.listChecked.length} datos correctamente.`))})}saveAllChecked(){this.listChecked=[],this.list.forEach(e=>{e.checked&&(delete e.checked,e.user=this.user.uid,this.listChecked.push(e))}),this.pickingService.saveListByUser(this.listChecked).subscribe(e=>{this.wsService.emit("picking")}),this.bsModalRef.hide()}ngOnDestroy(){this.suscription$.unsubscribe()}closeModal(){console.log("close"),this.bsModalRef.hide()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p),t.Y36(u.uU),t.Y36(l.qu),t.Y36(x.e),t.Y36(A.v_),t.Y36(m.UZ),t.Y36(J.i))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-select-routes"]],inputs:{listLength:"listLength"},decls:19,vars:8,consts:[[1,"modal-header"],[1,"modal-title","pull-left"],["class","btn btn-danger",3,"click",4,"ngIf"],[1,"modal-body"],[1,"row"],[1,"col-md-3","d-flex",3,"formGroup"],["type","date","formControlName","date",1,"form-control","mr-2"],["type","button",1,"btn","btn-sm","btn-danger","ms-1",3,"click"],[1,"col-md-8"],[1,"col-md-1","d-flex","justify-content-center"],[1,"btn","btn-link",3,"click"],[3,"icon"],[1,"border","mt-4"],["class","text-center mt-4 fw-bold",4,"ngIf"],["class","m-3",4,"ngFor","ngForOf"],["class","text-center mt-4",4,"ngIf"],[1,"btn","btn-danger",3,"click"],[1,"text-center","mt-4","fw-bold"],[1,"m-3"],["type","checkbox",1,"form-check-input","largerCheckBox","me-2","mt-0","fw-bold",3,"click"],[1,"text-center","mt-4"],[1,"btn","btn-success",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"h4",1),t._uU(2),t.qZA(),t.YNc(3,I,2,0,"a",2),t.qZA(),t.TgZ(4,"div",3),t.TgZ(5,"div",4),t.TgZ(6,"div",5),t._UZ(7,"input",6),t.TgZ(8,"button",7),t.NdJ("click",function(){return i.watch()}),t._uU(9,"Ver"),t.qZA(),t.qZA(),t._UZ(10,"div",8),t.TgZ(11,"div",9),t.TgZ(12,"button",10),t.NdJ("click",function(){return i.watch()}),t._UZ(13,"fa-icon",11),t.qZA(),t.qZA(),t.qZA(),t.TgZ(14,"div",12),t.YNc(15,F,3,3,"h3",13),t.YNc(16,Y,3,2,"label",14),t._UZ(17,"br"),t.qZA(),t.YNc(18,$,3,0,"div",15),t.qZA()),2&e&&(t.xp6(2),t.Oqu(i.title),t.xp6(1),t.Q6J("ngIf",i.listLength>0),t.xp6(3),t.Q6J("formGroup",i.form),t.xp6(7),t.Q6J("icon",t.DdM(7,j)),t.xp6(2),t.Q6J("ngIf",i.message),t.xp6(1),t.Q6J("ngForOf",i.list),t.xp6(2),t.Q6J("ngIf",i.list.length>0))},directives:[u.O5,l.JL,l.sg,l.Fj,l.JJ,l.u,f.BN,u.sg],pipes:[u.gd],styles:["input.largerCheckBox[_ngcontent-%COMP%]{width:25px;height:25px}  .modal-dialog{max-width:95vw;max-height:95vh;width:1500px;height:800px}  .modal-content{height:100%}"]}),n})();function B(n,o){if(1&n&&(t.TgZ(0,"tr",8),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",12),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.qZA()),2&n){const e=o.$implicit,i=o.index;t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(null==e?null:e.name),t.xp6(2),t.Oqu(null==e?null:e.units)}}let z=(()=>{class n{constructor(e,i){this.pickingService=e,this.bsModalRef=i,this.picking="",this.units=[]}ngOnInit(){this.getDetail()}onConfirm(){this.bsModalRef.content.onClose.next(!0),this.bsModalRef.hide()}onCancel(){this.bsModalRef.content.onClose.next(!1),this.bsModalRef.hide()}getDetail(){this.pickingService.listDetail(this.picking._id).subscribe(e=>{this.units=e.detail.filter(i=>i.units>0)})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p),t.Y36(m.UZ))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-unit-detail"]],inputs:{picking:"picking"},decls:30,vars:4,consts:[[1,"scrollModal"],[1,"modal-header"],[1,"modal-title","d-flex","justify-content-between","w-100"],[1,"modal-body"],[1,"table-responsive"],[1,"table","table-sm","table-striped","table-bordered"],[1,"fw-bold","text-center","table-primary",2,"font-size","14px"],["class","text-center align-middle",4,"ngFor","ngForOf"],[1,"text-center","align-middle"],["colspan","2"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary","btn-mobile",3,"click"],[1,"text-start"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"h5",2),t.TgZ(3,"span"),t._uU(4,"Unidades"),t.qZA(),t.TgZ(5,"span"),t._uU(6),t.qZA(),t.TgZ(7,"span"),t._uU(8),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"div",3),t.TgZ(10,"div",4),t.TgZ(11,"table",5),t.TgZ(12,"thead"),t.TgZ(13,"tr",6),t.TgZ(14,"th"),t._uU(15,"#"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Nombre"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Unidades"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(20,"tbody"),t.YNc(21,B,7,3,"tr",7),t.TgZ(22,"tr",8),t.TgZ(23,"th",9),t._uU(24,"Total"),t.qZA(),t.TgZ(25,"th"),t._uU(26),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(27,"div",10),t.TgZ(28,"button",11),t.NdJ("click",function(){return i.onCancel()}),t._uU(29,"Cerrar"),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(6),t.hij("Ruta: ",null==i.picking?null:i.picking.route,""),t.xp6(2),t.hij("Viaje: ",null==i.picking?null:i.picking.travel,""),t.xp6(13),t.Q6J("ngForOf",i.units),t.xp6(5),t.Oqu(null==i.picking?null:i.picking.units))},directives:[u.sg],styles:[".scrollModal[_ngcontent-%COMP%]{max-width:95vw;max-height:95vh}.table-responsive[_ngcontent-%COMP%]{max-height:75vh}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10}"]}),n})();const L=function(n){return{blink:n}};function V(n,o){if(1&n&&(t.TgZ(0,"div",1),t.TgZ(1,"div",2),t.TgZ(2,"span"),t._uU(3),t.qZA(),t.TgZ(4,"span"),t._uU(5),t.qZA(),t.TgZ(6,"span"),t._uU(7),t.qZA(),t.qZA(),t.qZA()),2&n){const e=t.oxw();t.Q6J("ngClass",t.VKq(4,L,!e.running)),t.xp6(3),t.hij("",e.hours,":"),t.xp6(2),t.hij("",e.minutes,":"),t.xp6(2),t.Oqu(e.seconds)}}let E=(()=>{class n{constructor(){this.hours="00",this.minutes="00",this.seconds="00",this.milliseconds="00",this.progress=0,this.action="",this.maxMin=0,this.laps=[],this.running=!1,this.startText="Empezar",this.start=!0,this.typeProg="success"}ngOnChanges(e){"number"==typeof this.milliseconds||this.clearTimer(),this.startTimer()}setProgress(e,i){i>0&&(e+=60*i),this.progress=Math.floor(100*e/this.maxMin),this.progress>50&&(this.typeProg="info"),this.progress>75&&(this.typeProg="warning"),this.progress>92&&(this.typeProg="danger")}startTimer(){if(this.running=!this.running,this.running){this.startText="Stop";const e=new Date(this.startTime).valueOf()-(this.counter||0);this.timerRef=setInterval(()=>{this.counter=Date.now()-e,this.hours=Math.floor(this.counter%864e5/36e5),this.minutes=Math.floor(this.counter%36e5/6e4),this.setProgress(this.minutes,this.hours),this.seconds=Math.floor(this.counter%6e4/1e3),this.minutes=Number(this.minutes)<10?"0"+this.minutes:""+this.minutes,this.milliseconds=Number(this.milliseconds)<10?"0"+this.milliseconds:""+this.milliseconds,this.seconds=Number(this.seconds)<10?"0"+this.seconds:""+this.seconds})}else this.startText="Resume",clearInterval(this.timerRef)}lapTimeSplit(){this.laps.push(this.minutes+":"+this.seconds+":"+this.milliseconds)}clearTimer(){this.running=!1,this.startText="Empezar",this.counter=void 0,this.milliseconds="00",this.seconds="00",this.minutes="00",this.hours="00",this.laps=[],clearInterval(this.timerRef)}ngOnDestroy(){clearInterval(this.timerRef)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-timer-picking"]],inputs:{start:"start",action:"action",showTimerControls:"showTimerControls",startTime:"startTime",maxMin:"maxMin"},features:[t.TTD],decls:2,vars:1,consts:[[3,"ngClass",4,"ngIf"],[3,"ngClass"],[1,"h5","fw-bold","my-1"]],template:function(e,i){1&e&&(t.TgZ(0,"section"),t.YNc(1,V,8,6,"div",0),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",i.startTime))},directives:[u.O5,u.mk],styles:[""]}),n})();function H(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(),c=s.$implicit,a=s.index;return t.oxw().confirmStart(c,a)}),t._uU(1," Inicio "),t.qZA()}}function G(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(),c=s.$implicit,a=s.index;return t.oxw().confirmFinish(c,a)}),t._uU(1," Fin "),t.qZA()}if(2&n){const e=t.oxw().$implicit;t.Q6J("disabled",void 0!==e.value.endTime)}}function X(n,o){if(1&n&&(t.TgZ(0,"div",26),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit,i=t.oxw();t.xp6(1),t.hij(" ",i.countdown(e.value.startTime,e.value.endTime)," ")}}function K(n,o){if(1&n&&t._UZ(0,"app-timer-picking",27),2&n){const e=t.oxw().$implicit;t.Q6J("start",e.value.start)("startTime",e.value.startTime)}}const _=function(){return["fas","eye"]};function W(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"tr",18),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td",11),t._uU(10),t.qZA(),t.TgZ(11,"td",11),t.TgZ(12,"fa-icon",19),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.oxw().boxDetail(c)}),t.qZA(),t.qZA(),t.TgZ(13,"td",12),t._uU(14),t.qZA(),t.TgZ(15,"td",12),t.TgZ(16,"fa-icon",19),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.oxw().bottleDetail(c)}),t.qZA(),t.qZA(),t.TgZ(17,"td",13),t._uU(18),t.qZA(),t.TgZ(19,"td",13),t.TgZ(20,"fa-icon",19),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.oxw().packageDetail(c)}),t.qZA(),t.qZA(),t.TgZ(21,"td",14),t._uU(22),t.qZA(),t.TgZ(23,"td",14),t.TgZ(24,"fa-icon",19),t.NdJ("click",function(){const c=t.CHM(e).$implicit;return t.oxw().unitDetail(c)}),t.qZA(),t.qZA(),t.TgZ(25,"td",14),t.YNc(26,H,2,0,"button",20),t.YNc(27,G,2,1,"button",21),t.qZA(),t.TgZ(28,"td"),t.YNc(29,X,2,1,"div",22),t.YNc(30,K,1,2,"app-timer-picking",23),t.qZA(),t.TgZ(31,"td"),t._uU(32),t.qZA(),t.qZA()}if(2&n){const e=o.$implicit,i=o.index;t.xp6(2),t.Oqu(i+1),t.xp6(2),t.Oqu(null==e||null==e.value?null:e.value.plaque),t.xp6(2),t.Oqu(null==e||null==e.value?null:e.value.route),t.xp6(2),t.Oqu(null==e||null==e.value?null:e.value.travel),t.xp6(2),t.Oqu(null==e||null==e.value?null:e.value.boxes),t.xp6(2),t.Q6J("icon",t.DdM(17,_)),t.xp6(2),t.Oqu(null==e||null==e.value?null:e.value.bottles),t.xp6(2),t.Q6J("icon",t.DdM(18,_)),t.xp6(2),t.Oqu(null==e||null==e.value?null:e.value.packages),t.xp6(2),t.Q6J("icon",t.DdM(19,_)),t.xp6(2),t.Oqu(null==e||null==e.value?null:e.value.units),t.xp6(2),t.Q6J("icon",t.DdM(20,_)),t.xp6(2),t.Q6J("ngIf",!e.value.startTime&&!e.value.endTime),t.xp6(1),t.Q6J("ngIf",e.value.startTime),t.xp6(2),t.Q6J("ngIf",e.value.startTime&&e.value.endTime),t.xp6(1),t.Q6J("ngIf",!e.value.startTime||!e.value.endTime),t.xp6(2),t.Oqu(null==e||null==e.value?null:e.value.totalUnits)}}const tt=function(){return["fas","clock"]},et=[{path:"",component:y,children:[{path:"enlistment",component:(()=>{class n{constructor(e,i,s,c,a,g){this.fb=e,this.pickingService=i,this.authService=s,this.modalService=c,this.datePipe=a,this.common=g,this.user=this.authService.user,this.form=this.fb.group({items:this.fb.array([]),date:[""]})}ngOnInit(){this.formatedDate=this.datePipe.transform(Date.now(),"yyyy-MM-dd"),this.form.get("date").patchValue(this.formatedDate),this.getStatus()}getStatus(){this.pickingService.statusUser(this.form.get("date").value).subscribe(e=>{e.ok?this.getPickings():e.ok||this.openModal()})}openModal(){this.subCategoryRef=this.modalService.show(Q,{class:"modal-dialog-centered modal-lg",keyboard:!1,backdrop:"static",initialState:{listLength:this.form.get("items").value.length}}),this.modalService.onHide.subscribe(e=>{this.getPickings()})}getPickings(){this.pickingService.list(this.form.get("date").value).subscribe(e=>{this.form.setControl("items",this.fb.array([]));const i=this.form.get("items");e&&e.length>0&&Object.keys(e).forEach(s=>{i.push(this.fb.group({_id:new l.NI({value:e[s]._id,disabled:!0}),route:new l.NI({value:e[s].route,disabled:!0}),travel:new l.NI({value:e[s].travel,disabled:!0}),plaque:new l.NI({value:e[s].plaque,disabled:!0}),boxes:new l.NI({value:e[s].boxes,disabled:!0}),bottles:new l.NI({value:e[s].bottles,disabled:!0}),packages:new l.NI({value:e[s].packages,disabled:!0}),units:new l.NI({value:e[s].units,disabled:!0}),startTime:new l.NI({value:e[s].startTime,disabled:!0}),endTime:new l.NI({value:e[s].endTime,disabled:!0}),totalUnits:new l.NI({value:e[s].totalUnits,disabled:!0}),preparer:new l.NI({value:this.user.uid,disabled:!0}),start:new l.NI({value:e[s].start,disabled:!0})}))})})}countdown(e,i){const s=new Date(e).getTime(),a=new Date(i).getTime()-s,g=Math.floor(a%864e5/36e5),h=Math.floor(a%36e5/6e4),k=Math.floor(a%6e4/1e3);return`${g}:${h<10?"0"+h:h}:${k<10?"0"+k:k}`}confirmStart(e,i){const s=this;this.common.showConfirmStart("CONTAR","Recuerda que una vez iniciado el conteo no podr\xe1s cambiarlo. \xbfDeseas continuar? ",function(a){a.isConfirmed&&s.start(e,i)})}confirmFinish(e,i){const s=this;this.common.showConfirmEnd("FINALIZAR","Recuerda que una vez finalizado el conteo no podr\xe1s cambiarlo. \xbfDeseas continuar? ",function(a){a.isConfirmed&&s.finish(e,i)})}start(e,i){this.form.get("items").controls[i].patchValue({startTime:new Date,start:!0}),this.pickingService.update(e.value._id,this.form.get("items").controls[i].value).subscribe()}finish(e,i){this.form.get("items").controls[i].patchValue({endTime:new Date,start:!1}),this.pickingService.update(e.value._id,this.form.get("items").controls[i].value).subscribe()}boxDetail(e){this.subCategoryRef=this.modalService.show(D,{class:"modal-dialog-centered modal-lg",initialState:{picking:e.value}}),this.subCategoryRef.content.onClose=new Z.x}bottleDetail(e){this.subCategoryRef=this.modalService.show(O,{class:"modal-dialog-centered modal-lg",initialState:{picking:e.value}}),this.subCategoryRef.content.onClose=new Z.x}packageDetail(e){this.subCategoryRef=this.modalService.show(N,{class:"modal-dialog-centered modal-lg",initialState:{picking:e.value}}),this.subCategoryRef.content.onClose=new Z.x}unitDetail(e){this.subCategoryRef=this.modalService.show(z,{class:"modal-dialog-centered modal-lg",initialState:{picking:e.value}}),this.subCategoryRef.content.onClose=new Z.x}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(l.qu),t.Y36(p),t.Y36(x.e),t.Y36(m.tT),t.Y36(u.uU),t.Y36(A.v_))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-picking"]],decls:46,vars:5,consts:[[1,"container-fluid"],[1,"row"],[1,"col-md-2","d-flex",3,"formGroup"],["type","date","formControlName","date",1,"form-control","mr-2"],["type","button",1,"btn","btn-sm","btn-danger","ms-1",3,"click"],[1,"col-md-9","mb-2"],[1,"col-md-1"],["type","button",1,"btn","btn-sm","btn-primary","ms-1",3,"click"],[1,"table-responsive","mt-3"],[1,"table","table-sm","table-striped","table-bordered",3,"formGroup"],[1,"fw-bold","text-center","table-primary",2,"font-size","14px"],[2,"background-color","#f7dae5"],[2,"background-color","#e2f0cb"],[2,"background-color","#c3e2e6"],[2,"background-color","#d0cce0"],[2,"width","62px","background-color","#d0cce0"],["size","lg",3,"icon"],["class","text-center align-middle",4,"ngFor","ngForOf"],[1,"text-center","align-middle"],["size","lg",1,"eye",3,"icon","click"],["type","button","class","btn btn-primary btn-sm",3,"click",4,"ngIf"],["type","button","class","btn btn-secondary btn-sm",3,"disabled","click",4,"ngIf"],["class","fw-bold",4,"ngIf"],[3,"start","startTime",4,"ngIf"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],["type","button",1,"btn","btn-secondary","btn-sm",3,"disabled","click"],[1,"fw-bold"],[3,"start","startTime"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"form",2),t._UZ(3,"input",3),t.TgZ(4,"button",4),t.NdJ("click",function(){return i.getPickings()}),t._uU(5,"Ver"),t.qZA(),t.qZA(),t._UZ(6,"div",5),t.TgZ(7,"div",6),t.TgZ(8,"button",7),t.NdJ("click",function(){return i.openModal()}),t._uU(9,"Seleccionar rutas"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"div",8),t.TgZ(11,"table",9),t.TgZ(12,"thead"),t.TgZ(13,"tr",10),t.TgZ(14,"th"),t._uU(15,"#"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Placa"),t.qZA(),t.TgZ(18,"th"),t._uU(19,"Ruta"),t.qZA(),t.TgZ(20,"th"),t._uU(21,"Viaje"),t.qZA(),t.TgZ(22,"th",11),t._uU(23,"Cajas"),t.qZA(),t.TgZ(24,"th",11),t._uU(25,"Ver"),t.qZA(),t.TgZ(26,"th",12),t._uU(27,"Botellas"),t.qZA(),t.TgZ(28,"th",12),t._uU(29,"Ver"),t.qZA(),t.TgZ(30,"th",13),t._uU(31,"Paquetes"),t.qZA(),t.TgZ(32,"th",13),t._uU(33,"Ver"),t.qZA(),t.TgZ(34,"th",14),t._uU(35,"Unidades"),t.qZA(),t.TgZ(36,"th",14),t._uU(37,"Ver"),t.qZA(),t.TgZ(38,"th",15),t._UZ(39,"fa-icon",16),t.qZA(),t.TgZ(40,"th"),t._uU(41,"Tiempo"),t.qZA(),t.TgZ(42,"th"),t._uU(43,"Total Unidades"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(44,"tbody"),t.YNc(45,W,33,21,"tr",17),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e){let s;t.xp6(2),t.Q6J("formGroup",i.form),t.xp6(9),t.Q6J("formGroup",i.form),t.xp6(28),t.Q6J("icon",t.DdM(4,tt)),t.xp6(6),t.Q6J("ngForOf",null==(s=i.form.get("items"))?null:s.controls)}},directives:[l._Y,l.JL,l.sg,l.Fj,l.JJ,l.u,f.BN,u.sg,u.O5,E],styles:[".eye[_ngcontent-%COMP%]{cursor:pointer}.eye[_ngcontent-%COMP%]:hover{color:#fff}"]}),n})()},{path:"",redirectTo:"enlistment",pathMatch:"full"}]}];let it=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[b.Bz.forChild(et)],b.Bz]}),n})();var nt=r(6802),T=r(801);let ot=(()=>{class n{constructor(e){e.addIcons(T.SZw,T.Mdf,T.d8e)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(f.by))},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[u.ez,it,nt.m,l.UX,f.uH]]}),n})()}}]);